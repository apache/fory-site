"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[95466],{62800:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>a});var d=i(85893),l=i(11151);const s={title:"Field Configuration",sidebar_position:5,id:"field_configuration",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},r=void 0,t={id:"guide/python/field_configuration",title:"Field Configuration",description:"This page explains how to configure field-level metadata for serialization in Python.",source:"@site/docs/guide/python/field-configuration.md",sourceDirName:"guide/python",slug:"/guide/python/field_configuration",permalink:"/docs/next/guide/python/field_configuration",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/docs/guide/python/field-configuration.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"Field Configuration",sidebar_position:5,id:"field_configuration",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"Custom Serializers",permalink:"/docs/next/guide/python/custom_serializers"},next:{title:"Python Native Mode",permalink:"/docs/next/guide/python/native_mode"}},c={},a=[{value:"Overview",id:"overview",level:2},{value:"Basic Syntax",id:"basic-syntax",level:2},{value:"The <code>pyfory.field()</code> Function",id:"the-pyforyfield-function",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Field ID (<code>id</code>)",id:"field-id-id",level:2},{value:"Nullable Fields (<code>nullable</code>)",id:"nullable-fields-nullable",level:2},{value:"Reference Tracking (<code>ref</code>)",id:"reference-tracking-ref",level:2},{value:"Skipping Fields (<code>ignore</code>)",id:"skipping-fields-ignore",level:2},{value:"Dynamic Fields (<code>dynamic</code>)",id:"dynamic-fields-dynamic",level:2},{value:"Integer Type Annotations",id:"integer-type-annotations",level:2},{value:"Signed Integers",id:"signed-integers",level:3},{value:"Unsigned Integers",id:"unsigned-integers",level:3},{value:"Floating Point",id:"floating-point",level:3},{value:"Encoding Summary",id:"encoding-summary",level:3},{value:"Complete Example",id:"complete-example",level:2},{value:"Cross-Language Compatibility",id:"cross-language-compatibility",level:2},{value:"Schema Evolution",id:"schema-evolution",level:2},{value:"Native Mode vs Xlang Mode",id:"native-mode-vs-xlang-mode",level:2},{value:"Native Mode (Python-only)",id:"native-mode-python-only",level:3},{value:"Xlang Mode (Cross-language)",id:"xlang-mode-cross-language",level:3},{value:"Default Values Summary",id:"default-values-summary",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Options Reference",id:"options-reference",level:2},{value:"Related Topics",id:"related-topics",level:2}];function o(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.a)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.p,{children:"This page explains how to configure field-level metadata for serialization in Python."}),"\n",(0,d.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,d.jsx)(n.p,{children:"Apache Fory\u2122 provides field-level configuration through:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:(0,d.jsx)(n.code,{children:"pyfory.field()"})}),": Configure field metadata (id, nullable, ref, ignore, dynamic)"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Type annotations"}),": Control integer encoding (varint, fixed, tagged)"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:(0,d.jsx)(n.code,{children:"Optional[T]"})}),": Mark fields as nullable"]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"This enables:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Tag IDs"}),": Assign compact numeric IDs to reduce struct field meta size overhead"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Nullability"}),": Control whether fields can be null"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Reference Tracking"}),": Enable reference tracking for shared objects"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Field Skipping"}),": Exclude fields from serialization"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Encoding Control"}),": Specify how integers are encoded (varint, fixed, tagged)"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Polymorphism"}),": Control whether type info is written for struct fields"]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"basic-syntax",children:"Basic Syntax"}),"\n",(0,d.jsxs)(n.p,{children:["Use ",(0,d.jsx)(n.code,{children:"@dataclass"})," decorator with type annotations and ",(0,d.jsx)(n.code,{children:"pyfory.field()"}),":"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:"from dataclasses import dataclass\nfrom typing import Optional\nimport pyfory\n\n@dataclass\nclass Person:\n    name: str = pyfory.field(id=0)\n    age: pyfory.int32 = pyfory.field(id=1, default=0)\n    nickname: Optional[str] = pyfory.field(id=2, nullable=True, default=None)\n"})}),"\n",(0,d.jsxs)(n.h2,{id:"the-pyforyfield-function",children:["The ",(0,d.jsx)(n.code,{children:"pyfory.field()"})," Function"]}),"\n",(0,d.jsxs)(n.p,{children:["Use ",(0,d.jsx)(n.code,{children:"pyfory.field()"})," to configure field-level metadata:"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:'@dataclass\nclass User:\n    id: pyfory.int64 = pyfory.field(id=0, default=0)\n    name: str = pyfory.field(id=1, default="")\n    email: Optional[str] = pyfory.field(id=2, nullable=True, default=None)\n    friends: List["User"] = pyfory.field(id=3, ref=True, default_factory=list)\n    _cache: dict = pyfory.field(ignore=True, default_factory=dict)\n'})}),"\n",(0,d.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Parameter"}),(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Default"}),(0,d.jsx)(n.th,{children:"Description"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"id"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"int"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"-1"})}),(0,d.jsx)(n.td,{children:"Field tag ID (-1 = use field name)"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"nullable"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"bool"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"False"})}),(0,d.jsx)(n.td,{children:"Whether the field can be null"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ref"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"bool"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"False"})}),(0,d.jsx)(n.td,{children:"Enable reference tracking"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ignore"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"bool"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"False"})}),(0,d.jsx)(n.td,{children:"Exclude field from serialization"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"dynamic"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"bool"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"None"})}),(0,d.jsx)(n.td,{children:"Control whether type info is written"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"default"})}),(0,d.jsx)(n.td,{children:"Any"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"MISSING"})}),(0,d.jsx)(n.td,{children:"Default value for the field"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"default_factory"})}),(0,d.jsx)(n.td,{children:"Callable"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"MISSING"})}),(0,d.jsx)(n.td,{children:"Factory function for default value"})]})]})]}),"\n",(0,d.jsxs)(n.h2,{id:"field-id-id",children:["Field ID (",(0,d.jsx)(n.code,{children:"id"}),")"]}),"\n",(0,d.jsx)(n.p,{children:"Assigns a numeric ID to a field to minimize struct field meta size overhead:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:'@dataclass\nclass User:\n    id: pyfory.int64 = pyfory.field(id=0, default=0)\n    name: str = pyfory.field(id=1, default="")\n    age: pyfory.int32 = pyfory.field(id=2, default=0)\n'})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Benefits"}),":"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Smaller serialized size (numeric IDs vs field names in metadata)"}),"\n",(0,d.jsx)(n.li,{children:"Reduced struct field meta overhead"}),"\n",(0,d.jsx)(n.li,{children:"Allows renaming fields without breaking binary compatibility"}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Recommendation"}),": It is recommended to configure field IDs for compatible mode since it reduces serialization cost."]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Notes"}),":"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"IDs must be unique within a class"}),"\n",(0,d.jsx)(n.li,{children:"IDs must be >= 0 (use -1 to use field name encoding, which is the default)"}),"\n",(0,d.jsx)(n.li,{children:"If not specified, field name is used in metadata (larger overhead)"}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Without field IDs"})," (field names used in metadata):"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:'@dataclass\nclass User:\n    id: pyfory.int64 = 0\n    name: str = ""\n'})}),"\n",(0,d.jsxs)(n.h2,{id:"nullable-fields-nullable",children:["Nullable Fields (",(0,d.jsx)(n.code,{children:"nullable"}),")"]}),"\n",(0,d.jsxs)(n.p,{children:["Use ",(0,d.jsx)(n.code,{children:"nullable=True"})," for fields that can be ",(0,d.jsx)(n.code,{children:"None"}),":"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:"from typing import Optional\n\n@dataclass\nclass Record:\n    # Nullable string field\n    optional_name: Optional[str] = pyfory.field(id=0, nullable=True, default=None)\n\n    # Nullable integer field\n    optional_count: Optional[pyfory.int32] = pyfory.field(id=1, nullable=True, default=None)\n"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Notes"}),":"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"Optional[T]"})," fields must have ",(0,d.jsx)(n.code,{children:"nullable=True"})]}),"\n",(0,d.jsxs)(n.li,{children:["Non-optional fields default to ",(0,d.jsx)(n.code,{children:"nullable=False"})]}),"\n"]}),"\n",(0,d.jsxs)(n.h2,{id:"reference-tracking-ref",children:["Reference Tracking (",(0,d.jsx)(n.code,{children:"ref"}),")"]}),"\n",(0,d.jsx)(n.p,{children:"Enable reference tracking for fields that may be shared or circular:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:'@dataclass\nclass RefOuter:\n    # Both fields may point to the same inner object\n    inner1: Optional[RefInner] = pyfory.field(id=0, ref=True, nullable=True, default=None)\n    inner2: Optional[RefInner] = pyfory.field(id=1, ref=True, nullable=True, default=None)\n\n\n@dataclass\nclass CircularRef:\n    name: str = pyfory.field(id=0, default="")\n    # Self-referencing field for circular references\n    self_ref: Optional["CircularRef"] = pyfory.field(id=1, ref=True, nullable=True, default=None)\n'})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Enable for fields that may be circular or shared"}),"\n",(0,d.jsx)(n.li,{children:"When the same object is referenced from multiple fields"}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Notes"}),":"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["Reference tracking only takes effect when ",(0,d.jsx)(n.code,{children:"Fory(ref=True)"})," is set globally"]}),"\n",(0,d.jsxs)(n.li,{children:["Field-level ",(0,d.jsx)(n.code,{children:"ref=True"})," AND global ",(0,d.jsx)(n.code,{children:"ref=True"})," must both be enabled"]}),"\n"]}),"\n",(0,d.jsxs)(n.h2,{id:"skipping-fields-ignore",children:["Skipping Fields (",(0,d.jsx)(n.code,{children:"ignore"}),")"]}),"\n",(0,d.jsx)(n.p,{children:"Exclude fields from serialization:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:'@dataclass\nclass User:\n    id: pyfory.int64 = pyfory.field(id=0, default=0)\n    name: str = pyfory.field(id=1, default="")\n    # Not serialized\n    _cache: dict = pyfory.field(ignore=True, default_factory=dict)\n    _internal_state: str = pyfory.field(ignore=True, default="")\n'})}),"\n",(0,d.jsxs)(n.h2,{id:"dynamic-fields-dynamic",children:["Dynamic Fields (",(0,d.jsx)(n.code,{children:"dynamic"}),")"]}),"\n",(0,d.jsx)(n.p,{children:"Control whether type information is written for struct fields. This is essential for polymorphism support:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:"from abc import ABC, abstractmethod\n\nclass Shape(ABC):\n    @abstractmethod\n    def area(self) -> float:\n        pass\n\n@dataclass\nclass Circle(Shape):\n    radius: float = 0.0\n\n    def area(self) -> float:\n        return 3.14159 * self.radius * self.radius\n\n@dataclass\nclass Container:\n    # Abstract class: dynamic is always True (type info written)\n    shape: Shape = pyfory.field(id=0)\n\n    # Force type info for concrete type (support runtime subtypes)\n    circle: Circle = pyfory.field(id=1, dynamic=True)\n\n    # Skip type info for concrete type (use declared type directly)\n    fixed_circle: Circle = pyfory.field(id=2, dynamic=False)\n"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Default Behavior"}),":"]}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Mode"}),(0,d.jsx)(n.th,{children:"Abstract Class"}),(0,d.jsx)(n.th,{children:"Concrete Object Types"}),(0,d.jsx)(n.th,{children:"Numeric/str/time Types"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Native mode"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"True"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"True"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"False"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Xlang mode"}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"True"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"False"})}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"False"})})]})]})]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"Notes"}),":"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Abstract classes"}),": ",(0,d.jsx)(n.code,{children:"dynamic"})," is always ",(0,d.jsx)(n.code,{children:"True"})," (type info must be written)"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Native mode"}),": ",(0,d.jsx)(n.code,{children:"dynamic"})," defaults to ",(0,d.jsx)(n.code,{children:"True"})," for object types, ",(0,d.jsx)(n.code,{children:"False"})," for numeric/str/time types"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Xlang mode"}),": ",(0,d.jsx)(n.code,{children:"dynamic"})," defaults to ",(0,d.jsx)(n.code,{children:"False"})," for concrete types"]}),"\n",(0,d.jsxs)(n.li,{children:["Use ",(0,d.jsx)(n.code,{children:"dynamic=True"})," when a concrete field may hold subclass instances"]}),"\n",(0,d.jsxs)(n.li,{children:["Use ",(0,d.jsx)(n.code,{children:"dynamic=False"})," for performance optimization when type is known"]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"integer-type-annotations",children:"Integer Type Annotations"}),"\n",(0,d.jsx)(n.p,{children:"Fory provides type annotations to control integer encoding:"}),"\n",(0,d.jsx)(n.h3,{id:"signed-integers",children:"Signed Integers"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:"@dataclass\nclass SignedIntegers:\n    byte_val: pyfory.int8 = 0      # 8-bit signed\n    short_val: pyfory.int16 = 0    # 16-bit signed\n    int_val: pyfory.int32 = 0      # 32-bit signed (varint encoding)\n    long_val: pyfory.int64 = 0     # 64-bit signed (varint encoding)\n"})}),"\n",(0,d.jsx)(n.h3,{id:"unsigned-integers",children:"Unsigned Integers"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:"@dataclass\nclass UnsignedIntegers:\n    # Fixed-size encoding\n    u8_val: pyfory.uint8 = 0       # 8-bit unsigned (fixed)\n    u16_val: pyfory.uint16 = 0     # 16-bit unsigned (fixed)\n\n    # Variable-length encoding (default for u32/u64)\n    u32_var: pyfory.uint32 = 0     # 32-bit unsigned (varint)\n    u64_var: pyfory.uint64 = 0     # 64-bit unsigned (varint)\n\n    # Explicit fixed-size encoding\n    u32_fixed: pyfory.fixed_uint32 = 0   # 32-bit unsigned (fixed 4 bytes)\n    u64_fixed: pyfory.fixed_uint64 = 0   # 64-bit unsigned (fixed 8 bytes)\n\n    # Tagged encoding (includes type tag)\n    u64_tagged: pyfory.tagged_uint64 = 0  # 64-bit unsigned (tagged)\n"})}),"\n",(0,d.jsx)(n.h3,{id:"floating-point",children:"Floating Point"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:"@dataclass\nclass FloatingPoint:\n    float_val: pyfory.float32 = 0.0   # 32-bit float\n    double_val: pyfory.float64 = 0.0  # 64-bit double\n"})}),"\n",(0,d.jsx)(n.h3,{id:"encoding-summary",children:"Encoding Summary"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Type"}),(0,d.jsx)(n.th,{children:"Encoding"}),(0,d.jsx)(n.th,{children:"Size"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.int8"})}),(0,d.jsx)(n.td,{children:"fixed"}),(0,d.jsx)(n.td,{children:"1 byte"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.int16"})}),(0,d.jsx)(n.td,{children:"fixed"}),(0,d.jsx)(n.td,{children:"2 bytes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.int32"})}),(0,d.jsx)(n.td,{children:"varint"}),(0,d.jsx)(n.td,{children:"1-5 bytes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.int64"})}),(0,d.jsx)(n.td,{children:"varint"}),(0,d.jsx)(n.td,{children:"1-10 bytes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.uint8"})}),(0,d.jsx)(n.td,{children:"fixed"}),(0,d.jsx)(n.td,{children:"1 byte"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.uint16"})}),(0,d.jsx)(n.td,{children:"fixed"}),(0,d.jsx)(n.td,{children:"2 bytes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.uint32"})}),(0,d.jsx)(n.td,{children:"varint"}),(0,d.jsx)(n.td,{children:"1-5 bytes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.uint64"})}),(0,d.jsx)(n.td,{children:"varint"}),(0,d.jsx)(n.td,{children:"1-10 bytes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.fixed_uint32"})}),(0,d.jsx)(n.td,{children:"fixed"}),(0,d.jsx)(n.td,{children:"4 bytes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.fixed_uint64"})}),(0,d.jsx)(n.td,{children:"fixed"}),(0,d.jsx)(n.td,{children:"8 bytes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.tagged_uint64"})}),(0,d.jsx)(n.td,{children:"tagged"}),(0,d.jsx)(n.td,{children:"1-9 bytes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.float32"})}),(0,d.jsx)(n.td,{children:"fixed"}),(0,d.jsx)(n.td,{children:"4 bytes"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.float64"})}),(0,d.jsx)(n.td,{children:"fixed"}),(0,d.jsx)(n.td,{children:"8 bytes"})]})]})]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"When to Use"}),":"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"varint"}),": Best for values that are often small (default for int32/int64/uint32/uint64)"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"fixed"}),": Best for values that use full range (e.g., timestamps, hashes)"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"tagged"}),": When type information needs to be preserved (uint64 only)"]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:'from dataclasses import dataclass\nfrom typing import Optional, List, Dict, Set\nimport pyfory\n\n\n@dataclass\nclass Document:\n    # Fields with tag IDs (recommended for compatible mode)\n    title: str = pyfory.field(id=0, default="")\n    version: pyfory.int32 = pyfory.field(id=1, default=0)\n\n    # Nullable field\n    description: Optional[str] = pyfory.field(id=2, nullable=True, default=None)\n\n    # Collection fields\n    tags: List[str] = pyfory.field(id=3, default_factory=list)\n    metadata: Dict[str, str] = pyfory.field(id=4, default_factory=dict)\n    categories: Set[str] = pyfory.field(id=5, default_factory=set)\n\n    # Unsigned integers with different encodings\n    view_count: pyfory.uint64 = pyfory.field(id=6, default=0)           # varint encoding\n    file_size: pyfory.fixed_uint64 = pyfory.field(id=7, default=0)      # fixed encoding\n    checksum: pyfory.tagged_uint64 = pyfory.field(id=8, default=0)      # tagged encoding\n\n    # Reference-tracked field for shared/circular references\n    parent: Optional["Document"] = pyfory.field(id=9, ref=True, nullable=True, default=None)\n\n    # Ignored field (not serialized)\n    _cache: dict = pyfory.field(ignore=True, default_factory=dict)\n\n\ndef main():\n    fory = pyfory.Fory(xlang=True, compatible=True, ref=True)\n    fory.register_type(Document, type_id=100)\n\n    doc = Document(\n        title="My Document",\n        version=1,\n        description="A sample document",\n        tags=["tag1", "tag2"],\n        metadata={"key": "value"},\n        categories={"cat1"},\n        view_count=42,\n        file_size=1024,\n        checksum=123456789,\n        parent=None,\n    )\n\n    # Serialize\n    data = fory.serialize(doc)\n\n    # Deserialize\n    decoded = fory.deserialize(data)\n    assert decoded.title == doc.title\n    assert decoded.version == doc.version\n\n\nif __name__ == "__main__":\n    main()\n'})}),"\n",(0,d.jsx)(n.h2,{id:"cross-language-compatibility",children:"Cross-Language Compatibility"}),"\n",(0,d.jsx)(n.p,{children:"When serializing data to be read by other languages (Java, Rust, C++, Go), use field IDs and matching type annotations:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:"@dataclass\nclass CrossLangData:\n    # Use field IDs for cross-language compatibility\n    int_var: pyfory.int32 = pyfory.field(id=0, default=0)\n    long_fixed: pyfory.fixed_uint64 = pyfory.field(id=1, default=0)\n    long_tagged: pyfory.tagged_uint64 = pyfory.field(id=2, default=0)\n    optional_value: Optional[str] = pyfory.field(id=3, nullable=True, default=None)\n"})}),"\n",(0,d.jsx)(n.h2,{id:"schema-evolution",children:"Schema Evolution"}),"\n",(0,d.jsx)(n.p,{children:"Compatible mode supports schema evolution. It is recommended to configure field IDs to reduce serialization cost:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:'# Version 1\n@dataclass\nclass DataV1:\n    id: pyfory.int64 = pyfory.field(id=0, default=0)\n    name: str = pyfory.field(id=1, default="")\n\n\n# Version 2: Added new field\n@dataclass\nclass DataV2:\n    id: pyfory.int64 = pyfory.field(id=0, default=0)\n    name: str = pyfory.field(id=1, default="")\n    email: Optional[str] = pyfory.field(id=2, nullable=True, default=None)  # New field\n'})}),"\n",(0,d.jsxs)(n.p,{children:["Data serialized with V1 can be deserialized with V2 (new field will be ",(0,d.jsx)(n.code,{children:"None"}),")."]}),"\n",(0,d.jsx)(n.p,{children:"Alternatively, field IDs can be omitted (field names will be used in metadata with larger overhead):"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:'@dataclass\nclass Data:\n    id: pyfory.int64 = 0\n    name: str = ""\n'})}),"\n",(0,d.jsx)(n.h2,{id:"native-mode-vs-xlang-mode",children:"Native Mode vs Xlang Mode"}),"\n",(0,d.jsx)(n.p,{children:"Field configuration behaves differently depending on the serialization mode:"}),"\n",(0,d.jsx)(n.h3,{id:"native-mode-python-only",children:"Native Mode (Python-only)"}),"\n",(0,d.jsxs)(n.p,{children:["Native mode has ",(0,d.jsx)(n.strong,{children:"relaxed default values"})," for maximum compatibility:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Nullable"}),": ",(0,d.jsx)(n.code,{children:"str"})," and numeric types are non-nullable by default unless ",(0,d.jsx)(n.code,{children:"Optional"})," is used"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Ref tracking"}),": Enabled by default for object references (except ",(0,d.jsx)(n.code,{children:"str"})," and numeric types)"]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["In native mode, you typically ",(0,d.jsx)(n.strong,{children:"don't need to configure field annotations"})," unless you want to:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Reduce serialized size by using field IDs"}),"\n",(0,d.jsx)(n.li,{children:"Optimize performance by disabling unnecessary ref tracking"}),"\n"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:'# Native mode: works without field configuration\n@dataclass\nclass User:\n    id: int = 0\n    name: str = ""\n    tags: List[str] = None\n'})}),"\n",(0,d.jsx)(n.h3,{id:"xlang-mode-cross-language",children:"Xlang Mode (Cross-language)"}),"\n",(0,d.jsxs)(n.p,{children:["Xlang mode has ",(0,d.jsx)(n.strong,{children:"stricter default values"})," due to type system differences between languages:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Nullable"}),": Fields are non-nullable by default (",(0,d.jsx)(n.code,{children:"nullable=False"}),")"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Ref tracking"}),": Disabled by default (",(0,d.jsx)(n.code,{children:"ref=False"}),")"]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["In xlang mode, you ",(0,d.jsx)(n.strong,{children:"need to configure fields"})," when:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["A field can be None (use ",(0,d.jsx)(n.code,{children:"Optional[T]"})," with ",(0,d.jsx)(n.code,{children:"nullable=True"}),")"]}),"\n",(0,d.jsxs)(n.li,{children:["A field needs reference tracking for shared/circular objects (use ",(0,d.jsx)(n.code,{children:"ref=True"}),")"]}),"\n",(0,d.jsx)(n.li,{children:"Integer types need specific encoding for cross-language compatibility"}),"\n",(0,d.jsx)(n.li,{children:"You want to reduce metadata size (use field IDs)"}),"\n"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-python",children:'# Xlang mode: explicit configuration required for nullable/ref fields\n@dataclass\nclass User:\n    id: pyfory.int64 = pyfory.field(id=0, default=0)\n    name: str = pyfory.field(id=1, default="")\n    email: Optional[str] = pyfory.field(id=2, nullable=True, default=None)  # Must declare nullable\n    friend: Optional["User"] = pyfory.field(id=3, ref=True, nullable=True, default=None)  # Must declare ref\n'})}),"\n",(0,d.jsx)(n.h3,{id:"default-values-summary",children:"Default Values Summary"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Option"}),(0,d.jsx)(n.th,{children:"Native Mode Default"}),(0,d.jsx)(n.th,{children:"Xlang Mode Default"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"nullable"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"False"})," for ",(0,d.jsx)(n.code,{children:"str"}),"/numeric; others nullable by default"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"False"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ref"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"True"})," (except ",(0,d.jsx)(n.code,{children:"str"})," and numeric types)"]}),(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"False"})})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"dynamic"})}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"True"})," (except numeric/str/time types)"]}),(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"False"})," (concrete)"]})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Configure field IDs"}),": Recommended for compatible mode to reduce serialization cost"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsxs)(n.strong,{children:["Use ",(0,d.jsx)(n.code,{children:"Optional[T]"})," with ",(0,d.jsx)(n.code,{children:"nullable=True"})]}),": Required for nullable fields in xlang mode"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Enable ref tracking for shared objects"}),": Use ",(0,d.jsx)(n.code,{children:"ref=True"})," when objects are shared or circular"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsxs)(n.strong,{children:["Use ",(0,d.jsx)(n.code,{children:"ignore=True"})," for sensitive data"]}),": Passwords, tokens, internal state"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Choose appropriate encoding"}),": ",(0,d.jsx)(n.code,{children:"varint"})," for small values, ",(0,d.jsx)(n.code,{children:"fixed"})," for full-range values"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Keep IDs stable"}),": Once assigned, don't change field IDs"]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"options-reference",children:"Options Reference"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Configuration"}),(0,d.jsx)(n.th,{children:"Description"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.field(id=N)"})}),(0,d.jsx)(n.td,{children:"Field tag ID to reduce metadata size"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.field(nullable=True)"})}),(0,d.jsx)(n.td,{children:"Mark field as nullable"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.field(ref=True)"})}),(0,d.jsx)(n.td,{children:"Enable reference tracking"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.field(ignore=True)"})}),(0,d.jsx)(n.td,{children:"Exclude field from serialization"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.field(dynamic=True)"})}),(0,d.jsx)(n.td,{children:"Force type info to be written"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.field(dynamic=False)"})}),(0,d.jsx)(n.td,{children:"Skip type info (use declared type)"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"Optional[T]"})}),(0,d.jsx)(n.td,{children:"Type hint for nullable fields"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"pyfory.int32"}),", ",(0,d.jsx)(n.code,{children:"pyfory.int64"})]}),(0,d.jsx)(n.td,{children:"Signed integers (varint encoding)"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"pyfory.uint32"}),", ",(0,d.jsx)(n.code,{children:"pyfory.uint64"})]}),(0,d.jsx)(n.td,{children:"Unsigned integers (varint encoding)"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsxs)(n.td,{children:[(0,d.jsx)(n.code,{children:"pyfory.fixed_uint32"}),", ",(0,d.jsx)(n.code,{children:"pyfory.fixed_uint64"})]}),(0,d.jsx)(n.td,{children:"Fixed-size unsigned"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"pyfory.tagged_uint64"})}),(0,d.jsx)(n.td,{children:"Tagged encoding for uint64"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"/docs/next/guide/python/basic_serialization",children:"Basic Serialization"})," - Getting started with Fory serialization"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"/docs/next/guide/python/schema_evolution",children:"Schema Evolution"})," - Compatible mode and schema evolution"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"/docs/next/guide/python/cross_language",children:"Cross-Language"})," - Interoperability with Java, Rust, C++, Go"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(o,{...e})}):o(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>t,a:()=>r});var d=i(67294);const l={},s=d.createContext(l);function r(e){const n=d.useContext(s);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),d.createElement(s.Provider,{value:n},e.children)}}}]);