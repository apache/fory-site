"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[96493],{83122:(e,i,r)=>{r.r(i),r.d(i,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>c,toc:()=>o});var n=r(85893),s=r(11151);const t={title:"Basic Serialization",sidebar_position:2,id:"basic_serialization",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},d=void 0,c={id:"guide/rust/basic_serialization",title:"Basic Serialization",description:"This page covers basic object graph serialization and supported types.",source:"@site/docs/guide/rust/basic-serialization.md",sourceDirName:"guide/rust",slug:"/guide/rust/basic_serialization",permalink:"/docs/next/guide/rust/basic_serialization",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/docs/guide/rust/basic-serialization.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Basic Serialization",sidebar_position:2,id:"basic_serialization",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"Configuration",permalink:"/docs/next/guide/rust/configuration"},next:{title:"Type Registration",permalink:"/docs/next/guide/rust/type_registration"}},l={},o=[{value:"Object Graph Serialization",id:"object-graph-serialization",level:2},{value:"Supported Types",id:"supported-types",level:2},{value:"Primitive Types",id:"primitive-types",level:3},{value:"Collections",id:"collections",level:3},{value:"Smart Pointers",id:"smart-pointers",level:3},{value:"Date and Time",id:"date-and-time",level:3},{value:"Custom Types",id:"custom-types",level:3},{value:"Serialization APIs",id:"serialization-apis",level:2},{value:"Performance Tips",id:"performance-tips",level:2},{value:"Related Topics",id:"related-topics",level:2}];function a(e){const i={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.p,{children:"This page covers basic object graph serialization and supported types."}),"\n",(0,n.jsx)(i.h2,{id:"object-graph-serialization",children:"Object Graph Serialization"}),"\n",(0,n.jsxs)(i.p,{children:["Apache Fory\u2122 provides automatic serialization of complex object graphs, preserving the structure and relationships between objects. The ",(0,n.jsx)(i.code,{children:"#[derive(ForyObject)]"})," macro generates efficient serialization code at compile time, eliminating runtime overhead."]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsx)(i.strong,{children:"Key capabilities:"})}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsx)(i.li,{children:"Nested struct serialization with arbitrary depth"}),"\n",(0,n.jsx)(i.li,{children:"Collection types (Vec, HashMap, HashSet, BTreeMap)"}),"\n",(0,n.jsxs)(i.li,{children:["Optional fields with ",(0,n.jsx)(i.code,{children:"Option<T>"})]}),"\n",(0,n.jsx)(i.li,{children:"Automatic handling of primitive types and strings"}),"\n",(0,n.jsx)(i.li,{children:"Efficient binary encoding with variable-length integers"}),"\n"]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-rust",children:'use fory::{Fory, Error};\nuse fory::ForyObject;\nuse std::collections::HashMap;\n\n#[derive(ForyObject, Debug, PartialEq)]\nstruct Person {\n    name: String,\n    age: i32,\n    address: Address,\n    hobbies: Vec<String>,\n    metadata: HashMap<String, String>,\n}\n\n#[derive(ForyObject, Debug, PartialEq)]\nstruct Address {\n    street: String,\n    city: String,\n    country: String,\n}\n\nlet mut fory = Fory::default();\nfory.register::<Address>(100);\nfory.register::<Person>(200);\n\nlet person = Person {\n    name: "John Doe".to_string(),\n    age: 30,\n    address: Address {\n        street: "123 Main St".to_string(),\n        city: "New York".to_string(),\n        country: "USA".to_string(),\n    },\n    hobbies: vec!["reading".to_string(), "coding".to_string()],\n    metadata: HashMap::from([\n        ("role".to_string(), "developer".to_string()),\n    ]),\n};\n\nlet bytes = fory.serialize(&person);\nlet decoded: Person = fory.deserialize(&bytes)?;\nassert_eq!(person, decoded);\n'})}),"\n",(0,n.jsx)(i.h2,{id:"supported-types",children:"Supported Types"}),"\n",(0,n.jsx)(i.h3,{id:"primitive-types",children:"Primitive Types"}),"\n",(0,n.jsxs)(i.table,{children:[(0,n.jsx)(i.thead,{children:(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.th,{children:"Rust Type"}),(0,n.jsx)(i.th,{children:"Description"})]})}),(0,n.jsxs)(i.tbody,{children:[(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"bool"})}),(0,n.jsx)(i.td,{children:"Boolean"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsxs)(i.td,{children:[(0,n.jsx)(i.code,{children:"i8"}),", ",(0,n.jsx)(i.code,{children:"i16"}),", ",(0,n.jsx)(i.code,{children:"i32"}),", ",(0,n.jsx)(i.code,{children:"i64"})]}),(0,n.jsx)(i.td,{children:"Signed integers"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsxs)(i.td,{children:[(0,n.jsx)(i.code,{children:"f32"}),", ",(0,n.jsx)(i.code,{children:"f64"})]}),(0,n.jsx)(i.td,{children:"Floating point"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"String"})}),(0,n.jsx)(i.td,{children:"UTF-8 string"})]})]})]}),"\n",(0,n.jsx)(i.h3,{id:"collections",children:"Collections"}),"\n",(0,n.jsxs)(i.table,{children:[(0,n.jsx)(i.thead,{children:(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.th,{children:"Rust Type"}),(0,n.jsx)(i.th,{children:"Description"})]})}),(0,n.jsxs)(i.tbody,{children:[(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"Vec<T>"})}),(0,n.jsx)(i.td,{children:"Dynamic array"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"VecDeque<T>"})}),(0,n.jsx)(i.td,{children:"Double-ended queue"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"LinkedList<T>"})}),(0,n.jsx)(i.td,{children:"Doubly-linked list"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"HashMap<K, V>"})}),(0,n.jsx)(i.td,{children:"Hash map"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"BTreeMap<K, V>"})}),(0,n.jsx)(i.td,{children:"Ordered map"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"HashSet<T>"})}),(0,n.jsx)(i.td,{children:"Hash set"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"BTreeSet<T>"})}),(0,n.jsx)(i.td,{children:"Ordered set"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"BinaryHeap<T>"})}),(0,n.jsx)(i.td,{children:"Binary heap"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"Option<T>"})}),(0,n.jsx)(i.td,{children:"Optional value"})]})]})]}),"\n",(0,n.jsx)(i.h3,{id:"smart-pointers",children:"Smart Pointers"}),"\n",(0,n.jsxs)(i.table,{children:[(0,n.jsx)(i.thead,{children:(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.th,{children:"Rust Type"}),(0,n.jsx)(i.th,{children:"Description"})]})}),(0,n.jsxs)(i.tbody,{children:[(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"Box<T>"})}),(0,n.jsx)(i.td,{children:"Heap allocation"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"Rc<T>"})}),(0,n.jsx)(i.td,{children:"Reference counting (shared refs tracked)"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"Arc<T>"})}),(0,n.jsx)(i.td,{children:"Thread-safe reference counting (shared refs tracked)"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"RcWeak<T>"})}),(0,n.jsxs)(i.td,{children:["Weak reference to ",(0,n.jsx)(i.code,{children:"Rc<T>"})," (breaks circular refs)"]})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"ArcWeak<T>"})}),(0,n.jsxs)(i.td,{children:["Weak reference to ",(0,n.jsx)(i.code,{children:"Arc<T>"})," (breaks circular refs)"]})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"RefCell<T>"})}),(0,n.jsx)(i.td,{children:"Interior mutability (runtime borrow checking)"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"Mutex<T>"})}),(0,n.jsx)(i.td,{children:"Thread-safe interior mutability"})]})]})]}),"\n",(0,n.jsx)(i.h3,{id:"date-and-time",children:"Date and Time"}),"\n",(0,n.jsxs)(i.table,{children:[(0,n.jsx)(i.thead,{children:(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.th,{children:"Rust Type"}),(0,n.jsx)(i.th,{children:"Description"})]})}),(0,n.jsxs)(i.tbody,{children:[(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"chrono::NaiveDate"})}),(0,n.jsx)(i.td,{children:"Date without timezone"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"chrono::NaiveDateTime"})}),(0,n.jsx)(i.td,{children:"Timestamp without timezone"})]})]})]}),"\n",(0,n.jsx)(i.h3,{id:"custom-types",children:"Custom Types"}),"\n",(0,n.jsxs)(i.table,{children:[(0,n.jsx)(i.thead,{children:(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.th,{children:"Macro"}),(0,n.jsx)(i.th,{children:"Description"})]})}),(0,n.jsxs)(i.tbody,{children:[(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"#[derive(ForyObject)]"})}),(0,n.jsx)(i.td,{children:"Object graph serialization"})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.code,{children:"#[derive(ForyRow)]"})}),(0,n.jsx)(i.td,{children:"Row-based serialization"})]})]})]}),"\n",(0,n.jsx)(i.h2,{id:"serialization-apis",children:"Serialization APIs"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-rust",children:"use fory::{Fory, Reader};\n\nlet mut fory = Fory::default();\nfory.register::<MyStruct>(1)?;\n\nlet obj = MyStruct { /* ... */ };\n\n// Basic serialize/deserialize\nlet bytes = fory.serialize(&obj)?;\nlet decoded: MyStruct = fory.deserialize(&bytes)?;\n\n// Serialize to existing buffer\nlet mut buf: Vec<u8> = vec![];\nfory.serialize_to(&mut buf, &obj)?;\n\n// Deserialize from reader\nlet mut reader = Reader::new(&buf);\nlet decoded: MyStruct = fory.deserialize_from(&mut reader)?;\n"})}),"\n",(0,n.jsx)(i.h2,{id:"performance-tips",children:"Performance Tips"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Zero-Copy Deserialization"}),": Row format enables direct memory access without copying"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Buffer Pre-allocation"}),": Minimizes memory allocations during serialization"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Compact Encoding"}),": Variable-length encoding for space efficiency"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Little-Endian"}),": Optimized for modern CPU architectures"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Reference Deduplication"}),": Shared objects serialized only once"]}),"\n"]}),"\n",(0,n.jsx)(i.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"/docs/next/guide/rust/type_registration",children:"Type Registration"})," - Registering types"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"/docs/next/guide/rust/references",children:"References"})," - Shared and circular references"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"/docs/next/guide/rust/custom_serializers",children:"Custom Serializers"})," - Manual serialization"]}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,s.a)(),...e.components};return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},11151:(e,i,r)=>{r.d(i,{Z:()=>c,a:()=>d});var n=r(67294);const s={},t=n.createContext(s);function d(e){const i=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),n.createElement(t.Provider,{value:i},e.children)}}}]);