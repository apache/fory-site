"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[24159],{22540:(e,r,i)=>{i.r(r),i.d(r,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>c});var n=i(85893),s=i(11151);const t={title:"Row Format",sidebar_position:9,id:"row_format",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},o=void 0,a={id:"guide/rust/row_format",title:"Row Format",description:"Apache Fory\u2122 provides a high-performance row format for zero-copy deserialization.",source:"@site/docs/guide/rust/row-format.md",sourceDirName:"guide/rust",slug:"/guide/rust/row_format",permalink:"/docs/next/guide/rust/row_format",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/docs/guide/rust/row-format.md",tags:[],version:"current",sidebarPosition:9,frontMatter:{title:"Row Format",sidebar_position:9,id:"row_format",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"Cross-Language Serialization",permalink:"/docs/next/guide/rust/cross_language"},next:{title:"Troubleshooting",permalink:"/docs/next/guide/rust/troubleshooting"}},l={},c=[{value:"Overview",id:"overview",level:2},{value:"When to Use Row Format",id:"when-to-use-row-format",level:2},{value:"Basic Usage",id:"basic-usage",level:2},{value:"How It Works",id:"how-it-works",level:2},{value:"Performance Comparison",id:"performance-comparison",level:2},{value:"ForyRow vs ForyObject",id:"foryrow-vs-foryobject",level:2},{value:"Related Topics",id:"related-topics",level:2}];function d(e){const r={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r.p,{children:["Apache Fory\u2122 provides a high-performance ",(0,n.jsx)(r.strong,{children:"row format"})," for zero-copy deserialization."]}),"\n",(0,n.jsx)(r.h2,{id:"overview",children:"Overview"}),"\n",(0,n.jsxs)(r.p,{children:["Unlike traditional object serialization that reconstructs entire objects in memory, row format enables ",(0,n.jsx)(r.strong,{children:"random access"})," to fields directly from binary data without full deserialization."]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.strong,{children:"Key benefits:"})}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Zero-copy access"}),": Read fields without allocating or copying data"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Partial deserialization"}),": Access only the fields you need"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Memory-mapped files"}),": Work with data larger than RAM"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Cache-friendly"}),": Sequential memory layout for better CPU cache utilization"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Lazy evaluation"}),": Defer expensive operations until field access"]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"when-to-use-row-format",children:"When to Use Row Format"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Analytics workloads with selective field access"}),"\n",(0,n.jsx)(r.li,{children:"Large datasets where only a subset of fields is needed"}),"\n",(0,n.jsx)(r.li,{children:"Memory-constrained environments"}),"\n",(0,n.jsx)(r.li,{children:"High-throughput data pipelines"}),"\n",(0,n.jsx)(r.li,{children:"Reading from memory-mapped files or shared memory"}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-rust",children:'use fory::{to_row, from_row};\nuse fory::ForyRow;\nuse std::collections::BTreeMap;\n\n#[derive(ForyRow)]\nstruct UserProfile {\n    id: i64,\n    username: String,\n    email: String,\n    scores: Vec<i32>,\n    preferences: BTreeMap<String, String>,\n    is_active: bool,\n}\n\nlet profile = UserProfile {\n    id: 12345,\n    username: "alice".to_string(),\n    email: "alice@example.com".to_string(),\n    scores: vec![95, 87, 92, 88],\n    preferences: BTreeMap::from([\n        ("theme".to_string(), "dark".to_string()),\n        ("language".to_string(), "en".to_string()),\n    ]),\n    is_active: true,\n};\n\n// Serialize to row format\nlet row_data = to_row(&profile);\n\n// Zero-copy deserialization - no object allocation!\nlet row = from_row::<UserProfile>(&row_data);\n\n// Access fields directly from binary data\nassert_eq!(row.id(), 12345);\nassert_eq!(row.username(), "alice");\nassert_eq!(row.email(), "alice@example.com");\nassert_eq!(row.is_active(), true);\n\n// Access collections efficiently\nlet scores = row.scores();\nassert_eq!(scores.size(), 4);\nassert_eq!(scores.get(0), 95);\nassert_eq!(scores.get(1), 87);\n\nlet prefs = row.preferences();\nassert_eq!(prefs.keys().size(), 2);\nassert_eq!(prefs.keys().get(0), "language");\nassert_eq!(prefs.values().get(0), "en");\n'})}),"\n",(0,n.jsx)(r.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Fields are encoded in a binary row with fixed offsets for primitives"}),"\n",(0,n.jsx)(r.li,{children:"Variable-length data (strings, collections) stored with offset pointers"}),"\n",(0,n.jsx)(r.li,{children:"Null bitmap tracks which fields are present"}),"\n",(0,n.jsx)(r.li,{children:"Nested structures supported through recursive row encoding"}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"performance-comparison",children:"Performance Comparison"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Operation"}),(0,n.jsx)(r.th,{children:"Object Format"}),(0,n.jsx)(r.th,{children:"Row Format"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Full deserialization"}),(0,n.jsx)(r.td,{children:"Allocates all objects"}),(0,n.jsx)(r.td,{children:"Zero allocation"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Single field access"}),(0,n.jsx)(r.td,{children:"Full deserialization required"}),(0,n.jsx)(r.td,{children:"Direct offset read"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Memory usage"}),(0,n.jsx)(r.td,{children:"Full object graph in memory"}),(0,n.jsx)(r.td,{children:"Only accessed fields in memory"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Suitable for"}),(0,n.jsx)(r.td,{children:"Small objects, full access"}),(0,n.jsx)(r.td,{children:"Large objects, selective access"})]})]})]}),"\n",(0,n.jsx)(r.h2,{id:"foryrow-vs-foryobject",children:"ForyRow vs ForyObject"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Feature"}),(0,n.jsx)(r.th,{children:(0,n.jsx)(r.code,{children:"#[derive(ForyRow)]"})}),(0,n.jsx)(r.th,{children:(0,n.jsx)(r.code,{children:"#[derive(ForyObject)]"})})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Deserialization"}),(0,n.jsx)(r.td,{children:"Zero-copy, lazy"}),(0,n.jsx)(r.td,{children:"Full object reconstruction"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Field access"}),(0,n.jsx)(r.td,{children:"Direct from binary"}),(0,n.jsx)(r.td,{children:"Normal struct access"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Memory usage"}),(0,n.jsx)(r.td,{children:"Minimal"}),(0,n.jsx)(r.td,{children:"Full object"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Best for"}),(0,n.jsx)(r.td,{children:"Analytics, large data"}),(0,n.jsx)(r.td,{children:"General serialization"})]})]})]}),"\n",(0,n.jsx)(r.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"/docs/next/guide/rust/basic_serialization",children:"Basic Serialization"})," - Object graph serialization"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"/docs/next/guide/rust/cross_language",children:"Cross-Language"})," - Row format across languages"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"https://fory.apache.org/docs/specification/row_format_spec",children:"Row Format Specification"})," - Protocol details"]}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,s.a)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},11151:(e,r,i)=>{i.d(r,{Z:()=>a,a:()=>o});var n=i(67294);const s={},t=n.createContext(s);function o(e){const r=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(t.Provider,{value:r},e.children)}}}]);