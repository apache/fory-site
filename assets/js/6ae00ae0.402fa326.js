"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[54310],{29965:(e,i,r)=>{r.r(i),r.d(i,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>l});var n=r(85893),s=r(11151);const t={title:"Rust Serialization Guide",sidebar_position:0,id:"serialization_index",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},a=void 0,o={id:"guide/rust/serialization_index",title:"Rust Serialization Guide",description:"Apache Fory\u2122 is a blazing fast multi-language serialization framework powered by JIT compilation and zero-copy techniques, providing up to ultra-fast performance while maintaining ease of use and safety.",source:"@site/versioned_docs/version-0.15/guide/rust/index.md",sourceDirName:"guide/rust",slug:"/guide/rust/",permalink:"/docs/guide/rust/",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/docs/guide/rust/index.md",tags:[],version:"0.15",sidebarPosition:0,frontMatter:{title:"Rust Serialization Guide",sidebar_position:0,id:"serialization_index",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"Troubleshooting",permalink:"/docs/guide/python/troubleshooting"},next:{title:"Configuration",permalink:"/docs/guide/rust/configuration"}},c={},l=[{value:"Why Apache Fory\u2122 Rust?",id:"why-apache-fory-rust",level:2},{value:"Crates",id:"crates",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Basic Example",id:"basic-example",level:3},{value:"Thread Safety",id:"thread-safety",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Use Cases",id:"use-cases",level:2},{value:"Object Serialization",id:"object-serialization",level:3},{value:"Row-Based Serialization",id:"row-based-serialization",level:3},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const i={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(i.p,{children:[(0,n.jsx)(i.strong,{children:"Apache Fory\u2122"})," is a blazing fast multi-language serialization framework powered by ",(0,n.jsx)(i.strong,{children:"JIT compilation"})," and ",(0,n.jsx)(i.strong,{children:"zero-copy"})," techniques, providing up to ",(0,n.jsx)(i.strong,{children:"ultra-fast performance"})," while maintaining ease of use and safety."]}),"\n",(0,n.jsx)(i.p,{children:"The Rust implementation provides versatile and high-performance serialization with automatic memory management and compile-time type safety."}),"\n",(0,n.jsx)(i.h2,{id:"why-apache-fory-rust",children:"Why Apache Fory\u2122 Rust?"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"\ud83d\udd25 Blazingly Fast"}),": Zero-copy deserialization and optimized binary protocols"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"\ud83c\udf0d Cross-Language"}),": Seamlessly serialize/deserialize data across Java, Python, C++, Go, JavaScript, and Rust"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"\ud83c\udfaf Type-Safe"}),": Compile-time type checking with derive macros"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"\ud83d\udd04 Circular References"}),": Automatic tracking of shared and circular references with ",(0,n.jsx)(i.code,{children:"Rc"}),"/",(0,n.jsx)(i.code,{children:"Arc"})," and weak pointers"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"\ud83e\uddec Polymorphic"}),": Serialize trait objects with ",(0,n.jsx)(i.code,{children:"Box<dyn Trait>"}),", ",(0,n.jsx)(i.code,{children:"Rc<dyn Trait>"}),", and ",(0,n.jsx)(i.code,{children:"Arc<dyn Trait>"})]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"\ud83d\udce6 Schema Evolution"}),": Compatible mode for independent schema changes"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"\u26a1 Two Formats"}),": Object graph serialization and zero-copy row-based format"]}),"\n"]}),"\n",(0,n.jsx)(i.h2,{id:"crates",children:"Crates"}),"\n",(0,n.jsxs)(i.table,{children:[(0,n.jsx)(i.thead,{children:(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.th,{children:"Crate"}),(0,n.jsx)(i.th,{children:"Description"}),(0,n.jsx)(i.th,{children:"Version"})]})}),(0,n.jsxs)(i.tbody,{children:[(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"https://github.com/apache/fory/blob/main/rust/fory",children:(0,n.jsx)(i.code,{children:"fory"})})}),(0,n.jsx)(i.td,{children:"High-level API with derive macros"}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"https://crates.io/crates/fory",children:(0,n.jsx)(i.img,{src:"https://img.shields.io/crates/v/fory.svg",alt:"crates.io"})})})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"https://github.com/apache/fory/blob/main/rust/fory-core/",children:(0,n.jsx)(i.code,{children:"fory-core"})})}),(0,n.jsx)(i.td,{children:"Core serialization engine"}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"https://crates.io/crates/fory-core",children:(0,n.jsx)(i.img,{src:"https://img.shields.io/crates/v/fory-core.svg",alt:"crates.io"})})})]}),(0,n.jsxs)(i.tr,{children:[(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"https://github.com/apache/fory/blob/main/rust/fory-derive/",children:(0,n.jsx)(i.code,{children:"fory-derive"})})}),(0,n.jsx)(i.td,{children:"Procedural macros"}),(0,n.jsx)(i.td,{children:(0,n.jsx)(i.a,{href:"https://crates.io/crates/fory-derive",children:(0,n.jsx)(i.img,{src:"https://img.shields.io/crates/v/fory-derive.svg",alt:"crates.io"})})})]})]})]}),"\n",(0,n.jsx)(i.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,n.jsxs)(i.p,{children:["Add Apache Fory\u2122 to your ",(0,n.jsx)(i.code,{children:"Cargo.toml"}),":"]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-toml",children:'[dependencies]\nfory = "0.13"\n'})}),"\n",(0,n.jsx)(i.h3,{id:"basic-example",children:"Basic Example"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-rust",children:'use fory::{Fory, Error, Reader};\nuse fory::ForyObject;\n\n#[derive(ForyObject, Debug, PartialEq)]\nstruct User {\n    name: String,\n    age: i32,\n    email: String,\n}\n\nfn main() -> Result<(), Error> {\n    let mut fory = Fory::default();\n    fory.register::<User>(1)?;\n\n    let user = User {\n        name: "Alice".to_string(),\n        age: 30,\n        email: "alice@example.com".to_string(),\n    };\n\n    // Serialize\n    let bytes = fory.serialize(&user)?;\n    // Deserialize\n    let decoded: User = fory.deserialize(&bytes)?;\n    assert_eq!(user, decoded);\n\n    // Serialize to specified buffer\n    let mut buf: Vec<u8> = vec![];\n    fory.serialize_to(&mut buf, &user)?;\n    // Deserialize from specified buffer\n    let mut reader = Reader::new(&buf);\n    let decoded: User = fory.deserialize_from(&mut reader)?;\n    assert_eq!(user, decoded);\n    Ok(())\n}\n'})}),"\n",(0,n.jsx)(i.h2,{id:"thread-safety",children:"Thread Safety"}),"\n",(0,n.jsxs)(i.p,{children:["Apache Fory\u2122 Rust is fully thread-safe: ",(0,n.jsx)(i.code,{children:"Fory"})," implements both ",(0,n.jsx)(i.code,{children:"Send"})," and ",(0,n.jsx)(i.code,{children:"Sync"}),", so one configured instance can be shared across threads for concurrent work. The internal read/write context pools are lazily initialized with thread-safe primitives, letting worker threads reuse buffers without coordination."]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-rust",children:"use fory::{Fory, Error};\nuse fory::ForyObject;\nuse std::sync::Arc;\nuse std::thread;\n\n#[derive(ForyObject, Clone, Copy, Debug, PartialEq)]\nstruct Item {\n    value: i32,\n}\n\nfn main() -> Result<(), Error> {\n    let mut fory = Fory::default();\n    fory.register::<Item>(1000)?;\n\n    let fory = Arc::new(fory);\n    let handles: Vec<_> = (0..8)\n        .map(|i| {\n            let shared = Arc::clone(&fory);\n            thread::spawn(move || {\n                let item = Item { value: i };\n                shared.serialize(&item)\n            })\n        })\n        .collect();\n\n    for handle in handles {\n        let bytes = handle.join().unwrap()?;\n        let item: Item = fory.deserialize(&bytes)?;\n        assert!(item.value >= 0);\n    }\n\n    Ok(())\n}\n"})}),"\n",(0,n.jsxs)(i.p,{children:[(0,n.jsx)(i.strong,{children:"Tip:"})," Perform registrations (such as ",(0,n.jsx)(i.code,{children:"fory.register::<T>(id)"}),") before spawning threads so every worker sees the same metadata. Once configured, wrapping the instance in ",(0,n.jsx)(i.code,{children:"Arc"})," is enough to fan out serialization and deserialization tasks safely."]}),"\n",(0,n.jsx)(i.h2,{id:"architecture",children:"Architecture"}),"\n",(0,n.jsx)(i.p,{children:"The Rust implementation consists of three main crates:"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"fory/                   # High-level API\n\u251c\u2500\u2500 src/lib.rs         # Public API exports\n\nfory-core/             # Core serialization engine\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 fory.rs       # Main serialization entry point\n\u2502   \u251c\u2500\u2500 buffer.rs     # Binary buffer management\n\u2502   \u251c\u2500\u2500 serializer/   # Type-specific serializers\n\u2502   \u251c\u2500\u2500 resolver/     # Type resolution and metadata\n\u2502   \u251c\u2500\u2500 meta/         # Meta string compression\n\u2502   \u251c\u2500\u2500 row/          # Row format implementation\n\u2502   \u2514\u2500\u2500 types.rs      # Type definitions\n\nfory-derive/           # Procedural macros\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 object/       # ForyObject macro\n\u2502   \u2514\u2500\u2500 fory_row.rs  # ForyRow macro\n"})}),"\n",(0,n.jsx)(i.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,n.jsx)(i.h3,{id:"object-serialization",children:"Object Serialization"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsx)(i.li,{children:"Complex data structures with nested objects and references"}),"\n",(0,n.jsx)(i.li,{children:"Cross-language communication in microservices"}),"\n",(0,n.jsx)(i.li,{children:"General-purpose serialization with full type safety"}),"\n",(0,n.jsx)(i.li,{children:"Schema evolution with compatible mode"}),"\n",(0,n.jsx)(i.li,{children:"Graph-like data structures with circular references"}),"\n"]}),"\n",(0,n.jsx)(i.h3,{id:"row-based-serialization",children:"Row-Based Serialization"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsx)(i.li,{children:"High-throughput data processing"}),"\n",(0,n.jsx)(i.li,{children:"Analytics workloads requiring fast field access"}),"\n",(0,n.jsx)(i.li,{children:"Memory-constrained environments"}),"\n",(0,n.jsx)(i.li,{children:"Real-time data streaming applications"}),"\n",(0,n.jsx)(i.li,{children:"Zero-copy scenarios"}),"\n"]}),"\n",(0,n.jsx)(i.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"/docs/guide/rust/configuration",children:"Configuration"})," - Fory builder options and modes"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"/docs/guide/rust/basic_serialization",children:"Basic Serialization"})," - Object graph serialization"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"/docs/guide/rust/references",children:"References"})," - Shared and circular references"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"/docs/guide/rust/polymorphism",children:"Polymorphism"})," - Trait object serialization"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"/docs/guide/rust/cross_language",children:"Cross-Language"})," - XLANG mode"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"/docs/guide/rust/row_format",children:"Row Format"})," - Zero-copy row-based format"]}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,s.a)(),...e.components};return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},11151:(e,i,r)=>{r.d(i,{Z:()=>o,a:()=>a});var n=r(67294);const s={},t=n.createContext(s);function a(e){const i=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),n.createElement(t.Provider,{value:i},e.children)}}}]);