"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[57566],{17003:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>d});var r=i(85893),s=i(11151);const a={title:"Basic Serialization",sidebar_position:20,id:"basic_serialization",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},t=void 0,l={id:"guide/go/basic_serialization",title:"Basic Serialization",description:"This guide covers the core serialization APIs in Fory Go.",source:"@site/versioned_docs/version-0.15/guide/go/basic-serialization.md",sourceDirName:"guide/go",slug:"/guide/go/basic_serialization",permalink:"/docs/guide/go/basic_serialization",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/docs/guide/go/basic-serialization.md",tags:[],version:"0.15",sidebarPosition:20,frontMatter:{title:"Basic Serialization",sidebar_position:20,id:"basic_serialization",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"Configuration",permalink:"/docs/guide/go/configuration"},next:{title:"Type Registration",permalink:"/docs/guide/go/type_registration"}},o={},d=[{value:"Creating a Fory Instance",id:"creating-a-fory-instance",level:2},{value:"Core API",id:"core-api",level:2},{value:"Serialize and Deserialize",id:"serialize-and-deserialize",level:3},{value:"Marshal and Unmarshal",id:"marshal-and-unmarshal",level:3},{value:"Serializing Primitives",id:"serializing-primitives",level:2},{value:"Serializing Collections",id:"serializing-collections",level:2},{value:"Slices",id:"slices",level:3},{value:"Maps",id:"maps",level:3},{value:"Serializing Structs",id:"serializing-structs",level:2},{value:"Basic Struct Serialization",id:"basic-struct-serialization",level:3},{value:"Nested Structs",id:"nested-structs",level:3},{value:"Pointer Fields",id:"pointer-fields",level:3},{value:"Streaming API",id:"streaming-api",level:2},{value:"SerializeTo",id:"serializeto",level:3},{value:"DeserializeFrom",id:"deserializefrom",level:3},{value:"Generic API (Type-Safe)",id:"generic-api-type-safe",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Nil Handling",id:"nil-handling",level:2},{value:"Nil Pointers",id:"nil-pointers",level:3},{value:"Empty Collections",id:"empty-collections",level:3},{value:"Complete Example",id:"complete-example",level:2},{value:"Related Topics",id:"related-topics",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"This guide covers the core serialization APIs in Fory Go."}),"\n",(0,r.jsx)(n.h2,{id:"creating-a-fory-instance",children:"Creating a Fory Instance"}),"\n",(0,r.jsx)(n.p,{children:"Create a Fory instance and register your types before serialization:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'import "github.com/apache/fory/go/fory"\n\nf := fory.New()\n\n// Register struct with a type ID\nf.RegisterStruct(User{}, 1)\nf.RegisterStruct(Order{}, 2)\n\n// Or register with a name (more flexible, less prone to ID conflicts, but higher serialization cost)\nf.RegisterNamedStruct(User{}, "example.User")\n\n// Register enum types\nf.RegisterEnum(Color(0), 3)\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Important"}),": The Fory instance should be reused across serialization calls. Creating a new instance involves allocating internal buffers, type caches, and resolvers, which is expensive. The default Fory instance is not thread-safe; for concurrent usage, use the thread-safe wrapper (see ",(0,r.jsx)(n.a,{href:"/docs/guide/go/thread_safety",children:"Thread Safety"}),")."]}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.a,{href:"/docs/guide/go/type_registration",children:"Type Registration"})," for more details."]}),"\n",(0,r.jsx)(n.h2,{id:"core-api",children:"Core API"}),"\n",(0,r.jsx)(n.h3,{id:"serialize-and-deserialize",children:"Serialize and Deserialize"}),"\n",(0,r.jsx)(n.p,{children:"The primary API for serialization:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:"// Serialize any value\ndata, err := f.Serialize(value)\nif err != nil {\n    // Handle error\n}\n\n// Deserialize into target\nvar result MyType\nerr = f.Deserialize(data, &result)\nif err != nil {\n    // Handle error\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"marshal-and-unmarshal",children:"Marshal and Unmarshal"}),"\n",(0,r.jsxs)(n.p,{children:["Aliases for ",(0,r.jsx)(n.code,{children:"Serialize"})," and ",(0,r.jsx)(n.code,{children:"Deserialize"})," (familiar to Go developers):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:"data, err := f.Marshal(value)\nerr = f.Unmarshal(data, &result)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"serializing-primitives",children:"Serializing Primitives"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'// Integers\ndata, _ := f.Serialize(int64(42))\nvar i int64\nf.Deserialize(data, &i)  // i = 42\n\n// Floats\ndata, _ = f.Serialize(float64(3.14))\nvar fl float64\nf.Deserialize(data, &fl)  // fl = 3.14\n\n// Strings\ndata, _ = f.Serialize("hello")\nvar s string\nf.Deserialize(data, &s)  // s = "hello"\n\n// Booleans\ndata, _ = f.Serialize(true)\nvar b bool\nf.Deserialize(data, &b)  // b = true\n'})}),"\n",(0,r.jsx)(n.h2,{id:"serializing-collections",children:"Serializing Collections"}),"\n",(0,r.jsx)(n.h3,{id:"slices",children:"Slices"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'// String slice\nstrs := []string{"a", "b", "c"}\ndata, _ := f.Serialize(strs)\n\nvar result []string\nf.Deserialize(data, &result)\n// result = ["a", "b", "c"]\n\n// Integer slice\nnums := []int64{1, 2, 3}\ndata, _ = f.Serialize(nums)\n\nvar intResult []int64\nf.Deserialize(data, &intResult)\n// intResult = [1, 2, 3]\n'})}),"\n",(0,r.jsx)(n.h3,{id:"maps",children:"Maps"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'// String to string map\nm := map[string]string{"key": "value"}\ndata, _ := f.Serialize(m)\n\nvar result map[string]string\nf.Deserialize(data, &result)\n// result = {"key": "value"}\n\n// String to int map\nm2 := map[string]int64{"count": 42}\ndata, _ = f.Serialize(m2)\n\nvar result2 map[string]int64\nf.Deserialize(data, &result2)\n// result2 = {"count": 42}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"serializing-structs",children:"Serializing Structs"}),"\n",(0,r.jsx)(n.h3,{id:"basic-struct-serialization",children:"Basic Struct Serialization"}),"\n",(0,r.jsxs)(n.p,{children:["Only ",(0,r.jsx)(n.strong,{children:"exported fields"})," (starting with uppercase) are serialized:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'type User struct {\n    ID       int64   // Serialized\n    Name     string  // Serialized\n    password string  // NOT serialized (unexported)\n}\n\nf.RegisterStruct(User{}, 1)\n\nuser := &User{ID: 1, Name: "Alice", password: "secret"}\ndata, _ := f.Serialize(user)\n\nvar result User\nf.Deserialize(data, &result)\n// result.ID = 1, result.Name = "Alice", result.password = ""\n'})}),"\n",(0,r.jsx)(n.h3,{id:"nested-structs",children:"Nested Structs"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'type Address struct {\n    City    string\n    Country string\n}\n\ntype Person struct {\n    Name    string\n    Address Address\n}\n\nf.RegisterStruct(Address{}, 1)\nf.RegisterStruct(Person{}, 2)\n\nperson := &Person{\n    Name: "Alice",\n    Address: Address{City: "NYC", Country: "USA"},\n}\n\ndata, _ := f.Serialize(person)\n\nvar result Person\nf.Deserialize(data, &result)\n// result.Address.City = "NYC"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"pointer-fields",children:"Pointer Fields"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:"type Node struct {\n    Value int32\n    Child *Node\n}\n\n// Use WithTrackRef for pointer fields\nf := fory.New(fory.WithTrackRef(true))\nf.RegisterStruct(Node{}, 1)\n\nroot := &Node{\n    Value: 1,\n    Child: &Node{Value: 2, Child: nil},\n}\n\ndata, _ := f.Serialize(root)\n\nvar result Node\nf.Deserialize(data, &result)\n// result.Child.Value = 2\n"})}),"\n",(0,r.jsx)(n.h2,{id:"streaming-api",children:"Streaming API"}),"\n",(0,r.jsx)(n.p,{children:"For scenarios where you want to control the buffer:"}),"\n",(0,r.jsx)(n.h3,{id:"serializeto",children:"SerializeTo"}),"\n",(0,r.jsx)(n.p,{children:"Serialize to an existing buffer:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:"buf := fory.NewByteBuffer(nil)\n\n// Serialize multiple values to same buffer\nf.SerializeTo(buf, value1)\nf.SerializeTo(buf, value2)\n\n// Get all serialized data\ndata := buf.GetByteSlice(0, buf.WriterIndex())\n"})}),"\n",(0,r.jsx)(n.h3,{id:"deserializefrom",children:"DeserializeFrom"}),"\n",(0,r.jsx)(n.p,{children:"Deserialize from an existing buffer:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:"buf := fory.NewByteBuffer(data)\n\nvar result1, result2 MyType\nf.DeserializeFrom(buf, &result1)\nf.DeserializeFrom(buf, &result2)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"generic-api-type-safe",children:"Generic API (Type-Safe)"}),"\n",(0,r.jsx)(n.p,{children:"Fory Go provides generic functions for type-safe serialization:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'import "github.com/apache/fory/go/fory"\n\ntype User struct {\n    ID   int64\n    Name string\n}\n\n// Type-safe serialization\nuser := &User{ID: 1, Name: "Alice"}\ndata, err := fory.Serialize(f, user)\n\n// Type-safe deserialization\nvar result User\nerr = fory.Deserialize(f, data, &result)\n'})}),"\n",(0,r.jsx)(n.p,{children:"The generic API:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Infers type at compile time"}),"\n",(0,r.jsx)(n.li,{children:"Provides better type safety"}),"\n",(0,r.jsx)(n.li,{children:"May offer performance benefits"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.p,{children:"Always check errors from serialization operations:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'data, err := f.Serialize(value)\nif err != nil {\n    switch e := err.(type) {\n    case fory.Error:\n        fmt.Printf("Fory error: %s (kind: %d)\\n", e.Error(), e.Kind())\n    default:\n        fmt.Printf("Unknown error: %v\\n", err)\n    }\n    return\n}\n\nerr = f.Deserialize(data, &result)\nif err != nil {\n    // Handle deserialization error\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Common error kinds:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ErrKindBufferOutOfBound"}),": Read/write beyond buffer bounds"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ErrKindTypeMismatch"}),": Type ID mismatch during deserialization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ErrKindUnknownType"}),": Unknown type encountered"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ErrKindMaxDepthExceeded"}),": Recursion depth limit exceeded"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ErrKindHashMismatch"}),": Struct hash mismatch (schema changed)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.a,{href:"/docs/guide/go/troubleshooting",children:"Troubleshooting"})," for error resolution."]}),"\n",(0,r.jsx)(n.h2,{id:"nil-handling",children:"Nil Handling"}),"\n",(0,r.jsx)(n.h3,{id:"nil-pointers",children:"Nil Pointers"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:"var ptr *User = nil\ndata, _ := f.Serialize(ptr)\n\nvar result *User\nf.Deserialize(data, &result)\n// result = nil\n"})}),"\n",(0,r.jsx)(n.h3,{id:"empty-collections",children:"Empty Collections"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:"// Nil slice\nvar slice []string = nil\ndata, _ := f.Serialize(slice)\n\nvar result []string\nf.Deserialize(data, &result)\n// result = nil\n\n// Empty slice (different from nil)\nempty := []string{}\ndata, _ = f.Serialize(empty)\n\nf.Deserialize(data, &result)\n// result = [] (empty, not nil)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n    "fmt"\n    "github.com/apache/fory/go/fory"\n)\n\ntype Order struct {\n    ID       int64\n    Customer string\n    Items    []Item\n    Total    float64\n}\n\ntype Item struct {\n    Name     string\n    Quantity int32\n    Price    float64\n}\n\nfunc main() {\n    f := fory.New()\n    f.RegisterStruct(Order{}, 1)\n    f.RegisterStruct(Item{}, 2)\n\n    order := &Order{\n        ID:       12345,\n        Customer: "Alice",\n        Items: []Item{\n            {Name: "Widget", Quantity: 2, Price: 9.99},\n            {Name: "Gadget", Quantity: 1, Price: 24.99},\n        },\n        Total: 44.97,\n    }\n\n    // Serialize\n    data, err := f.Serialize(order)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf("Serialized %d bytes\\n", len(data))\n\n    // Deserialize\n    var result Order\n    if err := f.Deserialize(data, &result); err != nil {\n        panic(err)\n    }\n\n    fmt.Printf("Order ID: %d\\n", result.ID)\n    fmt.Printf("Customer: %s\\n", result.Customer)\n    fmt.Printf("Items: %d\\n", len(result.Items))\n    fmt.Printf("Total: %.2f\\n", result.Total)\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/guide/go/configuration",children:"Configuration"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/guide/go/type_registration",children:"Type Registration"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/guide/go/supported_types",children:"Supported Types"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/guide/go/references",children:"References"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>l,a:()=>t});var r=i(67294);const s={},a=r.createContext(s);function t(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);