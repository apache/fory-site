"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[37923],{54136:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>g,frontMatter:()=>a,metadata:()=>t,toc:()=>c});var r=i(85893),s=i(11151);const a={title:"Cross-Language Serialization",sidebar_position:8,id:"cross_language",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},o=void 0,t={id:"guide/java/cross_language",title:"Cross-Language Serialization",description:"Apache Fory\u2122 supports seamless data exchange between Java and other languages (Python, Rust, Go, JavaScript, etc.) through the xlang serialization format. This enables multi-language microservices, polyglot data pipelines, and cross-platform data sharing.",source:"@site/versioned_docs/version-0.15/guide/java/cross-language.md",sourceDirName:"guide/java",slug:"/guide/java/cross_language",permalink:"/docs/guide/java/cross_language",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/docs/guide/java/cross-language.md",tags:[],version:"0.15",sidebarPosition:8,frontMatter:{title:"Cross-Language Serialization",sidebar_position:8,id:"cross_language",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"Advanced Features",permalink:"/docs/guide/java/advanced_features"},next:{title:"Row Format",permalink:"/docs/guide/java/row_format"}},l={},c=[{value:"Enable Cross-Language Mode",id:"enable-cross-language-mode",level:2},{value:"Register Types for Cross-Language Compatibility",id:"register-types-for-cross-language-compatibility",level:2},{value:"Register by ID (Recommended for Performance)",id:"register-by-id-recommended-for-performance",level:3},{value:"Register by Name (Recommended for Flexibility)",id:"register-by-name-recommended-for-flexibility",level:3},{value:"Cross-Language Example: Java \u2194 Python",id:"cross-language-example-java--python",level:2},{value:"Java (Serializer)",id:"java-serializer",level:3},{value:"Python (Deserializer)",id:"python-deserializer",level:3},{value:"Handling Circular and Shared References",id:"handling-circular-and-shared-references",level:2},{value:"Type Mapping Considerations",id:"type-mapping-considerations",level:2},{value:"Compatible Types",id:"compatible-types",level:3},{value:"Problematic Types",id:"problematic-types",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Cross-Language Best Practices",id:"cross-language-best-practices",level:2},{value:"Troubleshooting Cross-Language Serialization",id:"troubleshooting-cross-language-serialization",level:2},{value:"&quot;Type not registered&quot; errors",id:"type-not-registered-errors",level:3},{value:"&quot;Type mismatch&quot; errors",id:"type-mismatch-errors",level:3},{value:"Data corruption or unexpected values",id:"data-corruption-or-unexpected-values",level:3},{value:"See Also",id:"see-also",level:2},{value:"Related Topics",id:"related-topics",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Apache Fory\u2122 supports seamless data exchange between Java and other languages (Python, Rust, Go, JavaScript, etc.) through the xlang serialization format. This enables multi-language microservices, polyglot data pipelines, and cross-platform data sharing."}),"\n",(0,r.jsx)(n.h2,{id:"enable-cross-language-mode",children:"Enable Cross-Language Mode"}),"\n",(0,r.jsxs)(n.p,{children:["To serialize data for consumption by other languages, use ",(0,r.jsx)(n.code,{children:"Language.XLANG"})," mode:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"import org.apache.fory.*;\nimport org.apache.fory.config.*;\n\n// Create Fory instance with XLANG mode\nFory fory = Fory.builder()\n    .withLanguage(Language.XLANG)\n    .withRefTracking(true)  // Enable reference tracking for complex graphs\n    .build();\n"})}),"\n",(0,r.jsx)(n.h2,{id:"register-types-for-cross-language-compatibility",children:"Register Types for Cross-Language Compatibility"}),"\n",(0,r.jsxs)(n.p,{children:["Types must be registered with ",(0,r.jsx)(n.strong,{children:"consistent IDs or names"})," across all languages. Fory supports two registration methods:"]}),"\n",(0,r.jsx)(n.h3,{id:"register-by-id-recommended-for-performance",children:"Register by ID (Recommended for Performance)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public record Person(String name, int age) {}\n\n// Register with numeric ID - faster and more compact\nfory.register(Person.class, 1);\n\nPerson person = new Person("Alice", 30);\nbyte[] bytes = fory.serialize(person);\n// bytes can be deserialized by Python, Rust, Go, etc.\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Benefits"}),": Faster serialization, smaller binary size\n",(0,r.jsx)(n.strong,{children:"Trade-offs"}),": Requires coordination to avoid ID conflicts across teams/services"]}),"\n",(0,r.jsx)(n.h3,{id:"register-by-name-recommended-for-flexibility",children:"Register by Name (Recommended for Flexibility)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public record Person(String name, int age) {}\n\n// Register with string name - more flexible\nfory.register(Person.class, "example.Person");\n\nPerson person = new Person("Alice", 30);\nbyte[] bytes = fory.serialize(person);\n// bytes can be deserialized by Python, Rust, Go, etc.\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Benefits"}),": Less prone to conflicts, easier management across teams, no coordination needed\n",(0,r.jsx)(n.strong,{children:"Trade-offs"}),": Slightly larger binary size due to string encoding"]}),"\n",(0,r.jsx)(n.h2,{id:"cross-language-example-java--python",children:"Cross-Language Example: Java \u2194 Python"}),"\n",(0,r.jsx)(n.h3,{id:"java-serializer",children:"Java (Serializer)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'import org.apache.fory.*;\nimport org.apache.fory.config.*;\n\npublic record Person(String name, int age) {}\n\npublic class Example {\n    public static void main(String[] args) {\n        Fory fory = Fory.builder()\n            .withLanguage(Language.XLANG)\n            .withRefTracking(true)\n            .build();\n\n        // Register with consistent name\n        fory.register(Person.class, "example.Person");\n\n        Person person = new Person("Bob", 25);\n        byte[] bytes = fory.serialize(person);\n\n        // Send bytes to Python service via network/file/queue\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"python-deserializer",children:"Python (Deserializer)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import pyfory\nfrom dataclasses import dataclass\n\n@dataclass\nclass Person:\n    name: str\n    age: pyfory.int32\n\n# Create Fory in xlang mode\nfory = pyfory.Fory(xlang=True, ref=True)\n\n# Register with the SAME name as Java\nfory.register_type(Person, typename="example.Person")\n\n# Deserialize bytes from Java\nperson = fory.deserialize(bytes_from_java)\nprint(f"{person.name}, {person.age}")  # Output: Bob, 25\n'})}),"\n",(0,r.jsx)(n.h2,{id:"handling-circular-and-shared-references",children:"Handling Circular and Shared References"}),"\n",(0,r.jsx)(n.p,{children:"Cross-language mode supports circular and shared references when reference tracking is enabled:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public class Node {\n    public String value;\n    public Node next;\n    public Node parent;\n}\n\nFory fory = Fory.builder()\n    .withLanguage(Language.XLANG)\n    .withRefTracking(true)  // Required for circular references\n    .build();\n\nfory.register(Node.class, "example.Node");\n\n// Create circular reference\nNode node1 = new Node();\nnode1.value = "A";\nNode node2 = new Node();\nnode2.value = "B";\nnode1.next = node2;\nnode2.parent = node1;  // Circular reference\n\nbyte[] bytes = fory.serialize(node1);\n// Python/Rust/Go can correctly deserialize this with circular references preserved\n'})}),"\n",(0,r.jsx)(n.h2,{id:"type-mapping-considerations",children:"Type Mapping Considerations"}),"\n",(0,r.jsx)(n.p,{children:"Not all Java types have equivalents in other languages. When using xlang mode:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.strong,{children:"primitive types"})," (",(0,r.jsx)(n.code,{children:"int"}),", ",(0,r.jsx)(n.code,{children:"long"}),", ",(0,r.jsx)(n.code,{children:"double"}),", ",(0,r.jsx)(n.code,{children:"String"}),") for maximum compatibility"]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.strong,{children:"standard collections"})," (",(0,r.jsx)(n.code,{children:"List"}),", ",(0,r.jsx)(n.code,{children:"Map"}),", ",(0,r.jsx)(n.code,{children:"Set"}),") instead of language-specific ones"]}),"\n",(0,r.jsxs)(n.li,{children:["Avoid ",(0,r.jsx)(n.strong,{children:"Java-specific types"})," like ",(0,r.jsx)(n.code,{children:"Optional"}),", ",(0,r.jsx)(n.code,{children:"BigDecimal"})," (unless the target language supports them)"]}),"\n",(0,r.jsxs)(n.li,{children:["See ",(0,r.jsx)(n.a,{href:"/docs/specification/xlang_type_mapping",children:"Type Mapping Guide"})," for complete compatibility matrix"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"compatible-types",children:"Compatible Types"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public record UserData(\n    String name,           // \u2705 Compatible\n    int age,               // \u2705 Compatible\n    List<String> tags,     // \u2705 Compatible\n    Map<String, Integer> scores  // \u2705 Compatible\n) {}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"problematic-types",children:"Problematic Types"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public record UserData(\n    Optional<String> name,    // \u274c Not cross-language compatible\n    BigDecimal balance,       // \u274c Limited support\n    EnumSet<Status> statuses  // \u274c Java-specific collection\n) {}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,r.jsx)(n.p,{children:"Cross-language mode has additional overhead compared to Java-only mode:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Type metadata encoding"}),": Adds extra bytes per type"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Type resolution"}),": Requires name/ID lookup during deserialization"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"For best performance"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.strong,{children:"ID-based registration"})," when possible (smaller encoding)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Disable reference tracking"})," if you don't need circular references (",(0,r.jsx)(n.code,{children:"withRefTracking(false)"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Java mode"})," (",(0,r.jsx)(n.code,{children:"Language.JAVA"}),") when only Java serialization is needed"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"cross-language-best-practices",children:"Cross-Language Best Practices"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Consistent Registration"}),": Ensure all services register types with identical IDs/names"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Version Compatibility"}),": Use compatible mode for schema evolution across services"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting-cross-language-serialization",children:"Troubleshooting Cross-Language Serialization"}),"\n",(0,r.jsx)(n.h3,{id:"type-not-registered-errors",children:'"Type not registered" errors'}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Verify type is registered with same ID/name on both sides"}),"\n",(0,r.jsx)(n.li,{children:"Check if type name has typos or case differences"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"type-mismatch-errors",children:'"Type mismatch" errors'}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Ensure field types are compatible across languages"}),"\n",(0,r.jsxs)(n.li,{children:["Review ",(0,r.jsx)(n.a,{href:"/docs/specification/xlang_type_mapping",children:"Type Mapping Guide"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"data-corruption-or-unexpected-values",children:"Data corruption or unexpected values"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Verify both sides use ",(0,r.jsx)(n.code,{children:"Language.XLANG"})," mode"]}),"\n",(0,r.jsx)(n.li,{children:"Ensure both sides have compatible Fory versions"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/specification/xlang_serialization_spec",children:"Cross-Language Serialization Specification"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/specification/xlang_type_mapping",children:"Type Mapping Reference"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/guide/python/cross_language",children:"Python Cross-Language Guide"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/guide/rust/cross_language",children:"Rust Cross-Language Guide"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/guide/java/schema_evolution",children:"Schema Evolution"})," - Compatible mode"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/guide/java/type_registration",children:"Type Registration"})," - Registration methods"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/guide/java/row_format",children:"Row Format"})," - Cross-language row format"]}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>t,a:()=>o});var r=i(67294);const s={},a=r.createContext(s);function o(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);