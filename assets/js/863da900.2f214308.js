"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[65633],{22346:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>d,metadata:()=>t,toc:()=>a});var r=i(85893),l=i(11151);const d={title:"Field Configuration",sidebar_position:5,id:"field_configuration",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},s=void 0,t={id:"guide/java/field_configuration",title:"Field Configuration",description:"This page explains how to configure field-level metadata for serialization in Java.",source:"@site/docs/guide/java/field-configuration.md",sourceDirName:"guide/java",slug:"/guide/java/field_configuration",permalink:"/docs/next/guide/java/field_configuration",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/docs/guide/java/field-configuration.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"Field Configuration",sidebar_position:5,id:"field_configuration",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"Custom Serializers",permalink:"/docs/next/guide/java/custom_serializers"},next:{title:"Schema Evolution",permalink:"/docs/next/guide/java/schema_evolution"}},c={},a=[{value:"Overview",id:"overview",level:2},{value:"Basic Syntax",id:"basic-syntax",level:2},{value:"The <code>@ForyField</code> Annotation",id:"the-foryfield-annotation",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Field ID (<code>id</code>)",id:"field-id-id",level:2},{value:"Nullable Fields (<code>nullable</code>)",id:"nullable-fields-nullable",level:2},{value:"Reference Tracking (<code>ref</code>)",id:"reference-tracking-ref",level:2},{value:"Dynamic (Polymorphism Control)",id:"dynamic-polymorphism-control",level:2},{value:"Skipping Fields",id:"skipping-fields",level:2},{value:"Using <code>@Ignore</code>",id:"using-ignore",level:3},{value:"Using <code>transient</code>",id:"using-transient",level:3},{value:"Integer Type Annotations",id:"integer-type-annotations",level:2},{value:"Signed 32-bit Integer (<code>@Int32Type</code>)",id:"signed-32-bit-integer-int32type",level:3},{value:"Signed 64-bit Integer (<code>@Int64Type</code>)",id:"signed-64-bit-integer-int64type",level:3},{value:"Unsigned Integers",id:"unsigned-integers",level:3},{value:"Encoding Summary",id:"encoding-summary",level:3},{value:"Complete Example",id:"complete-example",level:2},{value:"Cross-Language Compatibility",id:"cross-language-compatibility",level:2},{value:"Schema Evolution",id:"schema-evolution",level:2},{value:"Native Mode vs Xlang Mode",id:"native-mode-vs-xlang-mode",level:2},{value:"Native Mode (Java-only)",id:"native-mode-java-only",level:3},{value:"Xlang Mode (Cross-language)",id:"xlang-mode-cross-language",level:3},{value:"Default Values Summary",id:"default-values-summary",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Annotations Reference",id:"annotations-reference",level:2},{value:"Related Topics",id:"related-topics",level:2}];function o(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"This page explains how to configure field-level metadata for serialization in Java."}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Apache Fory\u2122 provides field-level configuration through annotations:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"@ForyField"})}),": Configure field metadata (id, nullable, ref, dynamic)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"@Ignore"})}),": Exclude fields from serialization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Integer type annotations"}),": Control integer encoding (varint, fixed, tagged, unsigned)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This enables:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tag IDs"}),": Assign compact numeric IDs to reduce struct field meta size overhead for compatible mode"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Nullability"}),": Control whether fields can be null"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reference Tracking"}),": Enable reference tracking for shared objects"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Field Skipping"}),": Exclude fields from serialization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Encoding Control"}),": Specify how integers are encoded"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Polymorphism Control"}),": Control type info writing for struct fields"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"basic-syntax",children:"Basic Syntax"}),"\n",(0,r.jsx)(n.p,{children:"Use annotations on fields:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"import org.apache.fory.annotation.ForyField;\n\npublic class Person {\n    @ForyField(id = 0)\n    private String name;\n\n    @ForyField(id = 1)\n    private int age;\n\n    @ForyField(id = 2, nullable = true)\n    private String nickname;\n}\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"the-foryfield-annotation",children:["The ",(0,r.jsx)(n.code,{children:"@ForyField"})," Annotation"]}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"@ForyField"})," to configure field-level metadata:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class User {\n    @ForyField(id = 0)\n    private long id;\n\n    @ForyField(id = 1)\n    private String name;\n\n    @ForyField(id = 2, nullable = true)\n    private String email;\n\n    @ForyField(id = 3, ref = true)\n    private List<User> friends;\n\n    @ForyField(id = 4, dynamic = ForyField.Dynamic.TRUE)\n    private Object data;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"id"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"int"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"-1"})}),(0,r.jsx)(n.td,{children:"Field tag ID (-1 = use field name)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nullable"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"boolean"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsx)(n.td,{children:"Whether the field can be null"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ref"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"boolean"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsx)(n.td,{children:"Enable reference tracking"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"dynamic"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Dynamic"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AUTO"})}),(0,r.jsx)(n.td,{children:"Control polymorphism for struct fields"})]})]})]}),"\n",(0,r.jsxs)(n.h2,{id:"field-id-id",children:["Field ID (",(0,r.jsx)(n.code,{children:"id"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Assigns a numeric ID to a field to minimize struct field meta size overhead for compatible mode:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class User {\n    @ForyField(id = 0)\n    private long id;\n\n    @ForyField(id = 1)\n    private String name;\n\n    @ForyField(id = 2)\n    private int age;\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Benefits"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Smaller serialized size (numeric IDs vs field names in metadata)"}),"\n",(0,r.jsx)(n.li,{children:"Reduced struct field meta overhead"}),"\n",(0,r.jsx)(n.li,{children:"Allows renaming fields without breaking binary compatibility"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Recommendation"}),": It is recommended to configure field IDs for compatible mode since it reduces serialization cost."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Notes"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"IDs must be unique within a class"}),"\n",(0,r.jsx)(n.li,{children:"IDs must be >= 0 (use -1 to use field name encoding, which is the default)"}),"\n",(0,r.jsx)(n.li,{children:"If not specified, field name is used in metadata (larger overhead)"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Without field IDs"})," (field names used in metadata):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class User {\n    private long id;\n    private String name;\n}\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"nullable-fields-nullable",children:["Nullable Fields (",(0,r.jsx)(n.code,{children:"nullable"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"nullable = true"})," for fields that can be ",(0,r.jsx)(n.code,{children:"null"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class Record {\n    // Nullable string field\n    @ForyField(id = 0, nullable = true)\n    private String optionalName;\n\n    // Nullable Integer field (boxed type)\n    @ForyField(id = 1, nullable = true)\n    private Integer optionalCount;\n\n    // Non-nullable field (default)\n    @ForyField(id = 2)\n    private String requiredName;\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Notes"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Default is ",(0,r.jsx)(n.code,{children:"nullable = false"})," (non-nullable)"]}),"\n",(0,r.jsxs)(n.li,{children:["When ",(0,r.jsx)(n.code,{children:"nullable = false"}),", Fory skips writing the null flag (saves 1 byte)"]}),"\n",(0,r.jsxs)(n.li,{children:["Boxed types (",(0,r.jsx)(n.code,{children:"Integer"}),", ",(0,r.jsx)(n.code,{children:"Long"}),", etc.) that can be null should use ",(0,r.jsx)(n.code,{children:"nullable = true"})]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"reference-tracking-ref",children:["Reference Tracking (",(0,r.jsx)(n.code,{children:"ref"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"Enable reference tracking for fields that may be shared or circular:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class RefOuter {\n    // Both fields may point to the same inner object\n    @ForyField(id = 0, ref = true, nullable = true)\n    private RefInner inner1;\n\n    @ForyField(id = 1, ref = true, nullable = true)\n    private RefInner inner2;\n}\n\npublic class CircularRef {\n    @ForyField(id = 0)\n    private String name;\n\n    // Self-referencing field for circular references\n    @ForyField(id = 1, ref = true, nullable = true)\n    private CircularRef selfRef;\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Use Cases"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Enable for fields that may be circular or shared"}),"\n",(0,r.jsx)(n.li,{children:"When the same object is referenced from multiple fields"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Notes"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Default is ",(0,r.jsx)(n.code,{children:"ref = false"})," (no reference tracking)"]}),"\n",(0,r.jsxs)(n.li,{children:["When ",(0,r.jsx)(n.code,{children:"ref = false"}),", avoids IdentityMap overhead and skips ref tracking flag"]}),"\n",(0,r.jsx)(n.li,{children:"Reference tracking only takes effect when global ref tracking is enabled"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"dynamic-polymorphism-control",children:"Dynamic (Polymorphism Control)"}),"\n",(0,r.jsx)(n.p,{children:"Controls polymorphism behavior for struct fields in cross-language serialization:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class Container {\n    // AUTO: Interface/abstract types are dynamic, concrete types are not\n    @ForyField(id = 0, dynamic = ForyField.Dynamic.AUTO)\n    private Animal animal;  // Interface - type info written\n\n    // FALSE: No type info written, uses declared type's serializer\n    @ForyField(id = 1, dynamic = ForyField.Dynamic.FALSE)\n    private Dog dog;  // Concrete - no type info\n\n    // TRUE: Type info written to support runtime subtypes\n    @ForyField(id = 2, dynamic = ForyField.Dynamic.TRUE)\n    private Object data;  // Force polymorphic\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Options"}),":"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Value"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"AUTO"})}),(0,r.jsx)(n.td,{children:"Auto-detect: interface/abstract are dynamic, concrete types are not"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"FALSE"})}),(0,r.jsx)(n.td,{children:"No type info written, uses declared type's serializer directly"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"TRUE"})}),(0,r.jsx)(n.td,{children:"Type info written to support subtypes at runtime"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"skipping-fields",children:"Skipping Fields"}),"\n",(0,r.jsxs)(n.h3,{id:"using-ignore",children:["Using ",(0,r.jsx)(n.code,{children:"@Ignore"})]}),"\n",(0,r.jsx)(n.p,{children:"Exclude fields from serialization:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"import org.apache.fory.annotation.Ignore;\n\npublic class User {\n    @ForyField(id = 0)\n    private long id;\n\n    @ForyField(id = 1)\n    private String name;\n\n    @Ignore\n    private String password;  // Not serialized\n\n    @Ignore\n    private Object internalState;  // Not serialized\n}\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"using-transient",children:["Using ",(0,r.jsx)(n.code,{children:"transient"})]}),"\n",(0,r.jsxs)(n.p,{children:["Java's ",(0,r.jsx)(n.code,{children:"transient"})," keyword also excludes fields:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class User {\n    @ForyField(id = 0)\n    private long id;\n\n    private transient String password;  // Not serialized\n    private transient Object cache;     // Not serialized\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"integer-type-annotations",children:"Integer Type Annotations"}),"\n",(0,r.jsx)(n.p,{children:"Fory provides annotations to control integer encoding for cross-language compatibility."}),"\n",(0,r.jsxs)(n.h3,{id:"signed-32-bit-integer-int32type",children:["Signed 32-bit Integer (",(0,r.jsx)(n.code,{children:"@Int32Type"}),")"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"import org.apache.fory.annotation.Int32Type;\n\npublic class MyStruct {\n    // Variable-length encoding (default) - compact for small values\n    @Int32Type(compress = true)\n    private int compactId;\n\n    // Fixed 4-byte encoding - consistent size\n    @Int32Type(compress = false)\n    private int fixedId;\n}\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"signed-64-bit-integer-int64type",children:["Signed 64-bit Integer (",(0,r.jsx)(n.code,{children:"@Int64Type"}),")"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"import org.apache.fory.annotation.Int64Type;\nimport org.apache.fory.config.LongEncoding;\n\npublic class MyStruct {\n    // Variable-length encoding (default)\n    @Int64Type(encoding = LongEncoding.VARINT)\n    private long compactId;\n\n    // Fixed 8-byte encoding\n    @Int64Type(encoding = LongEncoding.FIXED)\n    private long fixedTimestamp;\n\n    // Tagged encoding (4 bytes for small values, 9 bytes otherwise)\n    @Int64Type(encoding = LongEncoding.TAGGED)\n    private long taggedValue;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"unsigned-integers",children:"Unsigned Integers"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"import org.apache.fory.annotation.Uint8Type;\nimport org.apache.fory.annotation.Uint16Type;\nimport org.apache.fory.annotation.Uint32Type;\nimport org.apache.fory.annotation.Uint64Type;\nimport org.apache.fory.config.LongEncoding;\n\npublic class UnsignedStruct {\n    // Unsigned 8-bit [0, 255]\n    @Uint8Type\n    private short flags;\n\n    // Unsigned 16-bit [0, 65535]\n    @Uint16Type\n    private int port;\n\n    // Unsigned 32-bit with varint encoding (default)\n    @Uint32Type(compress = true)\n    private long compactCount;\n\n    // Unsigned 32-bit with fixed encoding\n    @Uint32Type(compress = false)\n    private long fixedCount;\n\n    // Unsigned 64-bit with various encodings\n    @Uint64Type(encoding = LongEncoding.VARINT)\n    private long varintU64;\n\n    @Uint64Type(encoding = LongEncoding.FIXED)\n    private long fixedU64;\n\n    @Uint64Type(encoding = LongEncoding.TAGGED)\n    private long taggedU64;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"encoding-summary",children:"Encoding Summary"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Annotation"}),(0,r.jsx)(n.th,{children:"Type ID"}),(0,r.jsx)(n.th,{children:"Encoding"}),(0,r.jsx)(n.th,{children:"Size"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Int32Type(compress = true)"})}),(0,r.jsx)(n.td,{children:"5"}),(0,r.jsx)(n.td,{children:"varint"}),(0,r.jsx)(n.td,{children:"1-5 bytes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Int32Type(compress = false)"})}),(0,r.jsx)(n.td,{children:"4"}),(0,r.jsx)(n.td,{children:"fixed"}),(0,r.jsx)(n.td,{children:"4 bytes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Int64Type(encoding = VARINT)"})}),(0,r.jsx)(n.td,{children:"7"}),(0,r.jsx)(n.td,{children:"varint"}),(0,r.jsx)(n.td,{children:"1-10 bytes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Int64Type(encoding = FIXED)"})}),(0,r.jsx)(n.td,{children:"6"}),(0,r.jsx)(n.td,{children:"fixed"}),(0,r.jsx)(n.td,{children:"8 bytes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Int64Type(encoding = TAGGED)"})}),(0,r.jsx)(n.td,{children:"8"}),(0,r.jsx)(n.td,{children:"tagged"}),(0,r.jsx)(n.td,{children:"4 or 9 bytes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Uint8Type"})}),(0,r.jsx)(n.td,{children:"9"}),(0,r.jsx)(n.td,{children:"fixed"}),(0,r.jsx)(n.td,{children:"1 byte"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Uint16Type"})}),(0,r.jsx)(n.td,{children:"10"}),(0,r.jsx)(n.td,{children:"fixed"}),(0,r.jsx)(n.td,{children:"2 bytes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Uint32Type(compress = true)"})}),(0,r.jsx)(n.td,{children:"12"}),(0,r.jsx)(n.td,{children:"varint"}),(0,r.jsx)(n.td,{children:"1-5 bytes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Uint32Type(compress = false)"})}),(0,r.jsx)(n.td,{children:"11"}),(0,r.jsx)(n.td,{children:"fixed"}),(0,r.jsx)(n.td,{children:"4 bytes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Uint64Type(encoding = VARINT)"})}),(0,r.jsx)(n.td,{children:"14"}),(0,r.jsx)(n.td,{children:"varint"}),(0,r.jsx)(n.td,{children:"1-10 bytes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Uint64Type(encoding = FIXED)"})}),(0,r.jsx)(n.td,{children:"13"}),(0,r.jsx)(n.td,{children:"fixed"}),(0,r.jsx)(n.td,{children:"8 bytes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Uint64Type(encoding = TAGGED)"})}),(0,r.jsx)(n.td,{children:"15"}),(0,r.jsx)(n.td,{children:"tagged"}),(0,r.jsx)(n.td,{children:"4 or 9 bytes"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"When to Use"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"varint"}),": Best for values that are often small (default)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"fixed"}),": Best for values that use full range (e.g., timestamps, hashes)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"tagged"}),": Good balance between size and performance"]}),"\n",(0,r.jsx)(n.li,{children:"Unsigned types: For cross-language compatibility with Rust, Go, C++"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'import org.apache.fory.Fory;\nimport org.apache.fory.annotation.ForyField;\nimport org.apache.fory.annotation.Ignore;\nimport org.apache.fory.annotation.Int64Type;\nimport org.apache.fory.annotation.Uint64Type;\nimport org.apache.fory.config.LongEncoding;\n\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Set;\n\npublic class Document {\n    // Fields with tag IDs (recommended for compatible mode)\n    @ForyField(id = 0)\n    private String title;\n\n    @ForyField(id = 1)\n    private int version;\n\n    // Nullable field\n    @ForyField(id = 2, nullable = true)\n    private String description;\n\n    // Collection fields\n    @ForyField(id = 3)\n    private List<String> tags;\n\n    @ForyField(id = 4)\n    private Map<String, String> metadata;\n\n    @ForyField(id = 5)\n    private Set<String> categories;\n\n    // Integer with different encodings\n    @ForyField(id = 6)\n    @Uint64Type(encoding = LongEncoding.VARINT)\n    private long viewCount;  // varint encoding\n\n    @ForyField(id = 7)\n    @Uint64Type(encoding = LongEncoding.FIXED)\n    private long fileSize;   // fixed encoding\n\n    @ForyField(id = 8)\n    @Uint64Type(encoding = LongEncoding.TAGGED)\n    private long checksum;   // tagged encoding\n\n    // Reference-tracked field for shared/circular references\n    @ForyField(id = 9, ref = true, nullable = true)\n    private Document parent;\n\n    // Ignored field (not serialized)\n    private transient Object cache;\n\n    // Getters and setters...\n}\n\n// Usage\npublic class Main {\n    public static void main(String[] args) {\n        Fory fory = Fory.builder()\n            .withXlang(true)\n            .withCompatible(true)\n            .withRefTracking(true)\n            .build();\n\n        fory.register(Document.class, 100);\n\n        Document doc = new Document();\n        doc.setTitle("My Document");\n        doc.setVersion(1);\n        doc.setDescription("A sample document");\n\n        // Serialize\n        byte[] data = fory.serialize(doc);\n\n        // Deserialize\n        Document decoded = (Document) fory.deserialize(data);\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"cross-language-compatibility",children:"Cross-Language Compatibility"}),"\n",(0,r.jsx)(n.p,{children:"When serializing data to be read by other languages (Python, Rust, C++, Go), use field IDs and matching type annotations:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class CrossLangData {\n    // Use field IDs for cross-language compatibility\n    @ForyField(id = 0)\n    @Int32Type(compress = true)\n    private int intVar;\n\n    @ForyField(id = 1)\n    @Uint64Type(encoding = LongEncoding.FIXED)\n    private long longFixed;\n\n    @ForyField(id = 2)\n    @Uint64Type(encoding = LongEncoding.TAGGED)\n    private long longTagged;\n\n    @ForyField(id = 3, nullable = true)\n    private String optionalValue;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"schema-evolution",children:"Schema Evolution"}),"\n",(0,r.jsx)(n.p,{children:"Compatible mode supports schema evolution. It is recommended to configure field IDs to reduce serialization cost:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// Version 1\npublic class DataV1 {\n    @ForyField(id = 0)\n    private long id;\n\n    @ForyField(id = 1)\n    private String name;\n}\n\n// Version 2: Added new field\npublic class DataV2 {\n    @ForyField(id = 0)\n    private long id;\n\n    @ForyField(id = 1)\n    private String name;\n\n    @ForyField(id = 2, nullable = true)\n    private String email;  // New field\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Data serialized with V1 can be deserialized with V2 (new field will be ",(0,r.jsx)(n.code,{children:"null"}),")."]}),"\n",(0,r.jsx)(n.p,{children:"Alternatively, field IDs can be omitted (field names will be used in metadata with larger overhead):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class Data {\n    private long id;\n    private String name;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"native-mode-vs-xlang-mode",children:"Native Mode vs Xlang Mode"}),"\n",(0,r.jsx)(n.p,{children:"Field configuration behaves differently depending on the serialization mode:"}),"\n",(0,r.jsx)(n.h3,{id:"native-mode-java-only",children:"Native Mode (Java-only)"}),"\n",(0,r.jsxs)(n.p,{children:["Native mode has ",(0,r.jsx)(n.strong,{children:"relaxed default values"})," for maximum compatibility:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Nullable"}),": Reference types are nullable by default"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ref tracking"}),": Enabled by default for object references (except ",(0,r.jsx)(n.code,{children:"String"}),", boxed types, and time types)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Polymorphism"}),": All non-final classes support polymorphism by default"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["In native mode, you typically ",(0,r.jsx)(n.strong,{children:"don't need to configure field annotations"})," unless you want to:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Reduce serialized size by using field IDs"}),"\n",(0,r.jsx)(n.li,{children:"Optimize performance by disabling unnecessary ref tracking"}),"\n",(0,r.jsx)(n.li,{children:"Control integer encoding for specific fields"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// Native mode: works without any annotations\npublic class User {\n    private long id;\n    private String name;\n    private List<String> tags;  // Nullable and ref-tracked by default\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"xlang-mode-cross-language",children:"Xlang Mode (Cross-language)"}),"\n",(0,r.jsxs)(n.p,{children:["Xlang mode has ",(0,r.jsx)(n.strong,{children:"stricter default values"})," due to type system differences between languages:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Nullable"}),": Fields are non-nullable by default (",(0,r.jsx)(n.code,{children:"nullable = false"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ref tracking"}),": Disabled by default (",(0,r.jsx)(n.code,{children:"ref = false"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Polymorphism"}),": Concrete types are non-polymorphic by default"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["In xlang mode, you ",(0,r.jsx)(n.strong,{children:"need to configure fields"})," when:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["A field can be null (use ",(0,r.jsx)(n.code,{children:"nullable = true"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["A field needs reference tracking for shared/circular objects (use ",(0,r.jsx)(n.code,{children:"ref = true"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"Integer types need specific encoding for cross-language compatibility"}),"\n",(0,r.jsx)(n.li,{children:"You want to reduce metadata size (use field IDs)"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// Xlang mode: explicit configuration required for nullable/ref fields\npublic class User {\n    @ForyField(id = 0)\n    private long id;\n\n    @ForyField(id = 1)\n    private String name;\n\n    @ForyField(id = 2, nullable = true)  // Must declare nullable\n    private String email;\n\n    @ForyField(id = 3, ref = true, nullable = true)  // Must declare ref for shared objects\n    private User friend;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"default-values-summary",children:"Default Values Summary"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Option"}),(0,r.jsx)(n.th,{children:"Native Mode Default"}),(0,r.jsx)(n.th,{children:"Xlang Mode Default"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"nullable"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"true"})," (reference types)"]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ref"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"true"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"dynamic"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"true"})," (non-final)"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"AUTO"})," (concrete types are final)"]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Configure field IDs"}),": Recommended for compatible mode to reduce serialization cost"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Use ",(0,r.jsx)(n.code,{children:"nullable = true"})," for nullable fields"]}),": Required for fields that can be null"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Enable ref tracking for shared objects"}),": Use ",(0,r.jsx)(n.code,{children:"ref = true"})," when objects are shared or circular"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Use ",(0,r.jsx)(n.code,{children:"@Ignore"})," or ",(0,r.jsx)(n.code,{children:"transient"})," for sensitive data"]}),": Passwords, tokens, internal state"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Choose appropriate encoding"}),": ",(0,r.jsx)(n.code,{children:"varint"})," for small values, ",(0,r.jsx)(n.code,{children:"fixed"})," for full-range values"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Keep IDs stable"}),": Once assigned, don't change field IDs"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Configure unsigned types for cross-language compatibility"}),": When interoperating with unsigned numbers in Rust, Go, C++"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"annotations-reference",children:"Annotations Reference"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Annotation"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@ForyField(id = N)"})}),(0,r.jsx)(n.td,{children:"Field tag ID to reduce metadata size"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@ForyField(nullable = true)"})}),(0,r.jsx)(n.td,{children:"Mark field as nullable"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@ForyField(ref = true)"})}),(0,r.jsx)(n.td,{children:"Enable reference tracking"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@ForyField(dynamic = ...)"})}),(0,r.jsx)(n.td,{children:"Control polymorphism for struct fields"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Ignore"})}),(0,r.jsx)(n.td,{children:"Exclude field from serialization"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Int32Type(compress = ...)"})}),(0,r.jsx)(n.td,{children:"32-bit signed integer encoding"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Int64Type(encoding = ...)"})}),(0,r.jsx)(n.td,{children:"64-bit signed integer encoding"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Uint8Type"})}),(0,r.jsx)(n.td,{children:"Unsigned 8-bit integer"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Uint16Type"})}),(0,r.jsx)(n.td,{children:"Unsigned 16-bit integer"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Uint32Type(compress = ...)"})}),(0,r.jsx)(n.td,{children:"Unsigned 32-bit integer encoding"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"@Uint64Type(encoding = ...)"})}),(0,r.jsx)(n.td,{children:"Unsigned 64-bit integer encoding"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/next/guide/java/basic_serialization",children:"Basic Serialization"})," - Getting started with Fory serialization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/next/guide/java/schema_evolution",children:"Schema Evolution"})," - Compatible mode and schema evolution"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/next/guide/java/cross_language",children:"Cross-Language"})," - Interoperability with Python, Rust, C++, Go"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>t,a:()=>s});var r=i(67294);const l={},d=r.createContext(l);function s(e){const n=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);