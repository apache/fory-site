"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[68235],{91728:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>a,toc:()=>l});var n=t(85893),r=t(11151);const s={title:"Type Registration & Security",sidebar_position:3,id:"type_registration",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},o=void 0,a={id:"guide/python/type_registration",title:"Type Registration & Security",description:"This page covers type registration mechanisms and security configurations.",source:"@site/docs/guide/python/type-registration.md",sourceDirName:"guide/python",slug:"/guide/python/type_registration",permalink:"/docs/next/guide/python/type_registration",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/docs/guide/python/type-registration.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Type Registration & Security",sidebar_position:3,id:"type_registration",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"Basic Serialization",permalink:"/docs/next/guide/python/basic_serialization"},next:{title:"Custom Serializers",permalink:"/docs/next/guide/python/custom_serializers"}},c={},l=[{value:"Type Registration",id:"type-registration",level:2},{value:"Registration Patterns",id:"registration-patterns",level:2},{value:"Pattern 1: Simple Registration",id:"pattern-1-simple-registration",level:3},{value:"Pattern 2: Cross-Language with Typename",id:"pattern-2-cross-language-with-typename",level:3},{value:"Pattern 3: With Custom Serializer",id:"pattern-3-with-custom-serializer",level:3},{value:"Pattern 4: Batch Registration",id:"pattern-4-batch-registration",level:3},{value:"Security Modes",id:"security-modes",level:2},{value:"Strict Mode (Recommended)",id:"strict-mode-recommended",level:3},{value:"Non-Strict Mode",id:"non-strict-mode",level:3},{value:"Max Depth Protection",id:"max-depth-protection",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Related Topics",id:"related-topics",level:2}];function d(e){const i={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.p,{children:"This page covers type registration mechanisms and security configurations."}),"\n",(0,n.jsx)(i.h2,{id:"type-registration",children:"Type Registration"}),"\n",(0,n.jsx)(i.p,{children:"In strict mode, only registered types can be deserialized. This prevents arbitrary code execution:"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-python",children:'import pyfory\n\n# Strict mode (recommended for production)\nf = pyfory.Fory(strict=True)\n\nclass SafeClass:\n    def __init__(self, data):\n        self.data = data\n\n# Must register types in strict mode\nf.register(SafeClass, typename="com.example.SafeClass")\n\n# Now serialization works\nobj = SafeClass("safe data")\ndata = f.serialize(obj)\nresult = f.deserialize(data)\n\n# Unregistered types will raise an exception\nclass UnsafeClass:\n    pass\n\n# This will fail in strict mode\ntry:\n    f.serialize(UnsafeClass())\nexcept Exception as e:\n    print("Security protection activated!")\n'})}),"\n",(0,n.jsx)(i.h2,{id:"registration-patterns",children:"Registration Patterns"}),"\n",(0,n.jsx)(i.h3,{id:"pattern-1-simple-registration",children:"Pattern 1: Simple Registration"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-python",children:"fory.register(MyClass, type_id=100)\n"})}),"\n",(0,n.jsx)(i.h3,{id:"pattern-2-cross-language-with-typename",children:"Pattern 2: Cross-Language with Typename"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-python",children:'fory.register(MyClass, typename="com.example.MyClass")\n'})}),"\n",(0,n.jsx)(i.h3,{id:"pattern-3-with-custom-serializer",children:"Pattern 3: With Custom Serializer"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-python",children:"fory.register(MyClass, type_id=100, serializer=MySerializer(fory, MyClass))\n"})}),"\n",(0,n.jsx)(i.h3,{id:"pattern-4-batch-registration",children:"Pattern 4: Batch Registration"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-python",children:"type_id = 100\nfor model_class in [User, Order, Product, Invoice]:\n    fory.register(model_class, type_id=type_id)\n    type_id += 1\n"})}),"\n",(0,n.jsx)(i.h2,{id:"security-modes",children:"Security Modes"}),"\n",(0,n.jsx)(i.h3,{id:"strict-mode-recommended",children:"Strict Mode (Recommended)"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-python",children:"# Always use strict=True in production\nfory = pyfory.Fory(strict=True)\n\n# Explicitly register allowed types\nfory.register(UserModel, type_id=100)\nfory.register(OrderModel, type_id=101)\n"})}),"\n",(0,n.jsx)(i.h3,{id:"non-strict-mode",children:"Non-Strict Mode"}),"\n",(0,n.jsxs)(i.p,{children:[(0,n.jsx)(i.strong,{children:"\u26a0\ufe0f Security Warning"}),": When ",(0,n.jsx)(i.code,{children:"strict=False"}),", Fory will deserialize arbitrary types, which can pose security risks if data comes from untrusted sources. Only use ",(0,n.jsx)(i.code,{children:"strict=False"})," in controlled environments where you trust the data source completely."]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-python",children:"# Only in trusted environments\nfory = pyfory.Fory(xlang=False, ref=True, strict=False)\n"})}),"\n",(0,n.jsxs)(i.p,{children:["If you do need to use ",(0,n.jsx)(i.code,{children:"strict=False"}),", configure a ",(0,n.jsx)(i.code,{children:"DeserializationPolicy"}),":"]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-python",children:"from pyfory import DeserializationPolicy\n\nclass SafePolicy(DeserializationPolicy):\n    def validate_class(self, cls, is_local, **kwargs):\n        # Block dangerous modules\n        if cls.__module__ in {'subprocess', 'os', '__builtin__'}:\n            raise ValueError(f\"Blocked: {cls}\")\n        return None\n\nfory = pyfory.Fory(xlang=False, strict=False, policy=SafePolicy())\n"})}),"\n",(0,n.jsx)(i.h2,{id:"max-depth-protection",children:"Max Depth Protection"}),"\n",(0,n.jsx)(i.p,{children:"Limit deserialization depth to prevent stack overflow attacks:"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-python",children:"fory = pyfory.Fory(\n    strict=True,\n    max_depth=100  # Adjust based on your data structure depth\n)\n"})}),"\n",(0,n.jsx)(i.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,n.jsxs)(i.ol,{children:["\n",(0,n.jsx)(i.li,{children:(0,n.jsxs)(i.strong,{children:["Always use ",(0,n.jsx)(i.code,{children:"strict=True"})," in production"]})}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsxs)(i.strong,{children:["Use ",(0,n.jsx)(i.code,{children:"type_id"})," for performance"]}),", ",(0,n.jsx)(i.code,{children:"typename"})," for flexibility"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.strong,{children:"Register all types upfront"})," before any serialization"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsxs)(i.strong,{children:["Set appropriate ",(0,n.jsx)(i.code,{children:"max_depth"})]})," based on your data structures"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsxs)(i.strong,{children:["Use ",(0,n.jsx)(i.code,{children:"DeserializationPolicy"})]})," when ",(0,n.jsx)(i.code,{children:"strict=False"})," is necessary"]}),"\n"]}),"\n",(0,n.jsx)(i.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"/docs/next/guide/python/configuration",children:"Configuration"})," - Fory parameters"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"/docs/next/guide/python/security",children:"Security"})," - DeserializationPolicy details"]}),"\n",(0,n.jsxs)(i.li,{children:[(0,n.jsx)(i.a,{href:"/docs/next/guide/python/custom_serializers",children:"Custom Serializers"})," - Custom serialization"]}),"\n"]})]})}function p(e={}){const{wrapper:i}={...(0,r.a)(),...e.components};return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},11151:(e,i,t)=>{t.d(i,{Z:()=>a,a:()=>o});var n=t(67294);const r={},s=n.createContext(r);function o(e){const i=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(s.Provider,{value:i},e.children)}}}]);