"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[78742],{42460:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var s=r(85893),i=r(11151);const o={title:"Generated Code",sidebar_position:5,id:"generated_code",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},t=void 0,a={id:"compiler/generated_code",title:"Generated Code",description:"This document explains generated code for each target language.",source:"@site/docs/compiler/generated-code.md",sourceDirName:"compiler",slug:"/compiler/generated_code",permalink:"/docs/next/compiler/generated_code",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/docs/compiler/generated-code.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"Generated Code",sidebar_position:5,id:"generated_code",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"Compiler Guide",permalink:"/docs/next/compiler/compiler_guide"},next:{title:"FlatBuffers IDL Support",permalink:"/docs/next/compiler/flatbuffers_idl"}},l={},d=[{value:"Reference Schemas",id:"reference-schemas",level:2},{value:"<code>addressbook.fdl</code> (excerpt)",id:"addressbookfdl-excerpt",level:3},{value:"<code>auto_id.fdl</code> (excerpt)",id:"auto_idfdl-excerpt",level:3},{value:"Java",id:"java",level:2},{value:"Output Layout",id:"output-layout",level:3},{value:"Type Generation",id:"type-generation",level:3},{value:"Registration",id:"registration",level:3},{value:"Usage",id:"usage",level:3},{value:"Python",id:"python",level:2},{value:"Output Layout",id:"output-layout-1",level:3},{value:"Type Generation",id:"type-generation-1",level:3},{value:"Registration",id:"registration-1",level:3},{value:"Usage",id:"usage-1",level:3},{value:"Rust",id:"rust",level:2},{value:"Output Layout",id:"output-layout-2",level:3},{value:"Type Generation",id:"type-generation-2",level:3},{value:"Registration",id:"registration-2",level:3},{value:"Usage",id:"usage-2",level:3},{value:"C++",id:"c",level:2},{value:"Output Layout",id:"output-layout-3",level:3},{value:"Type Generation",id:"type-generation-3",level:3},{value:"Registration",id:"registration-3",level:3},{value:"Usage",id:"usage-3",level:3},{value:"Go",id:"go",level:2},{value:"Output Layout",id:"output-layout-4",level:3},{value:"Type Generation",id:"type-generation-4",level:3},{value:"Registration",id:"registration-4",level:3},{value:"Usage",id:"usage-4",level:3},{value:"C#",id:"c-1",level:2},{value:"Output Layout",id:"output-layout-5",level:3},{value:"Type Generation",id:"type-generation-5",level:3},{value:"Registration",id:"registration-5",level:3},{value:"Cross-Language Notes",id:"cross-language-notes",level:2},{value:"Type ID Behavior",id:"type-id-behavior",level:3},{value:"Nested Type Shape",id:"nested-type-shape",level:3},{value:"Byte Helper Naming",id:"byte-helper-naming",level:3}];function c(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"This document explains generated code for each target language."}),"\n",(0,s.jsxs)(n.p,{children:["Fory IDL generated types are idiomatic in host languages and can be used directly as domain objects. Generated types also include ",(0,s.jsx)(n.code,{children:"to/from bytes"})," helpers and registration helpers."]}),"\n",(0,s.jsx)(n.h2,{id:"reference-schemas",children:"Reference Schemas"}),"\n",(0,s.jsx)(n.p,{children:"The examples below use two real schemas:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"addressbook.fdl"})," (explicit type IDs)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"auto_id.fdl"})," (no explicit type IDs)"]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"addressbookfdl-excerpt",children:[(0,s.jsx)(n.code,{children:"addressbook.fdl"})," (excerpt)"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-protobuf",children:'package addressbook;\n\noption go_package = "github.com/myorg/myrepo/gen/addressbook;addressbook";\n\nmessage Person [id=100] {\n    string name = 1;\n    int32 id = 2;\n\n    enum PhoneType [id=101] {\n        PHONE_TYPE_MOBILE = 0;\n        PHONE_TYPE_HOME = 1;\n        PHONE_TYPE_WORK = 2;\n    }\n\n    message PhoneNumber [id=102] {\n        string number = 1;\n        PhoneType phone_type = 2;\n    }\n\n    list<PhoneNumber> phones = 7;\n    Animal pet = 8;\n}\n\nmessage Dog [id=104] {\n    string name = 1;\n    int32 bark_volume = 2;\n}\n\nmessage Cat [id=105] {\n    string name = 1;\n    int32 lives = 2;\n}\n\nunion Animal [id=106] {\n    Dog dog = 1;\n    Cat cat = 2;\n}\n\nmessage AddressBook [id=103] {\n    list<Person> people = 1;\n    map<string, Person> people_by_name = 2;\n}\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"auto_idfdl-excerpt",children:[(0,s.jsx)(n.code,{children:"auto_id.fdl"})," (excerpt)"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-protobuf",children:"package auto_id;\n\nenum Status {\n    UNKNOWN = 0;\n    OK = 1;\n}\n\nmessage Envelope {\n    string id = 1;\n\n    message Payload {\n        int32 value = 1;\n    }\n\n    union Detail {\n        Payload payload = 1;\n        string note = 2;\n    }\n\n    Payload payload = 2;\n    Detail detail = 3;\n    Status status = 4;\n}\n\nunion Wrapper {\n    Envelope envelope = 1;\n    string raw = 2;\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"java",children:"Java"}),"\n",(0,s.jsx)(n.h3,{id:"output-layout",children:"Output Layout"}),"\n",(0,s.jsxs)(n.p,{children:["For ",(0,s.jsx)(n.code,{children:"package addressbook"}),", Java output is generated under:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"<java_out>/addressbook/"})}),"\n",(0,s.jsxs)(n.li,{children:["Type files: ",(0,s.jsx)(n.code,{children:"AddressBook.java"}),", ",(0,s.jsx)(n.code,{children:"Person.java"}),", ",(0,s.jsx)(n.code,{children:"Dog.java"}),", ",(0,s.jsx)(n.code,{children:"Cat.java"}),", ",(0,s.jsx)(n.code,{children:"Animal.java"})]}),"\n",(0,s.jsxs)(n.li,{children:["Registration helper: ",(0,s.jsx)(n.code,{children:"AddressbookForyRegistration.java"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"type-generation",children:"Type Generation"}),"\n",(0,s.jsxs)(n.p,{children:["Messages generate Java classes with ",(0,s.jsx)(n.code,{children:"@ForyField"}),", default constructors, getters/setters, and byte helpers:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public class Person {\n    public static enum PhoneType {\n        MOBILE,\n        HOME,\n        WORK;\n    }\n\n    public static class PhoneNumber {\n        @ForyField(id = 1)\n        private String number;\n\n        @ForyField(id = 2)\n        private PhoneType phoneType;\n\n        public byte[] toBytes() { ... }\n        public static PhoneNumber fromBytes(byte[] bytes) { ... }\n    }\n\n    @ForyField(id = 1)\n    private String name;\n\n    @ForyField(id = 8)\n    private Animal pet;\n\n    public byte[] toBytes() { ... }\n    public static Person fromBytes(byte[] bytes) { ... }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Unions generate classes extending ",(0,s.jsx)(n.code,{children:"org.apache.fory.type.union.Union"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public final class Animal extends Union {\n    public enum AnimalCase {\n        DOG(1),\n        CAT(2);\n        public final int id;\n        AnimalCase(int id) { this.id = id; }\n    }\n\n    public static Animal ofDog(Dog v) { ... }\n    public AnimalCase getAnimalCase() { ... }\n    public int getAnimalCaseId() { ... }\n\n    public boolean hasDog() { ... }\n    public Dog getDog() { ... }\n    public void setDog(Dog v) { ... }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"registration",children:"Registration"}),"\n",(0,s.jsx)(n.p,{children:"Generated registration helper:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public static void register(Fory fory) {\n    org.apache.fory.resolver.TypeResolver resolver = fory.getTypeResolver();\n    resolver.registerUnion(Animal.class, 106L, new org.apache.fory.serializer.UnionSerializer(fory, Animal.class));\n    resolver.register(Person.class, 100L);\n    resolver.register(Person.PhoneType.class, 101L);\n    resolver.register(Person.PhoneNumber.class, 102L);\n    resolver.register(Dog.class, 104L);\n    resolver.register(Cat.class, 105L);\n    resolver.register(AddressBook.class, 103L);\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For schemas without explicit ",(0,s.jsx)(n.code,{children:"[id=...]"}),", generated registration uses computed numeric IDs (for example from ",(0,s.jsx)(n.code,{children:"auto_id.fdl"}),"):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"resolver.register(Status.class, 1124725126L);\nresolver.registerUnion(Wrapper.class, 1471345060L, new org.apache.fory.serializer.UnionSerializer(fory, Wrapper.class));\nresolver.register(Envelope.class, 3022445236L);\nresolver.registerUnion(Envelope.Detail.class, 1609214087L, new org.apache.fory.serializer.UnionSerializer(fory, Envelope.Detail.class));\nresolver.register(Envelope.Payload.class, 2862577837L);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If ",(0,s.jsx)(n.code,{children:"option enable_auto_type_id = false;"})," is set, registration uses namespace and type name:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'resolver.register(Config.class, "myapp.models", "Config");\nresolver.registerUnion(\n    Holder.class,\n    "myapp.models",\n    "Holder",\n    new org.apache.fory.serializer.UnionSerializer(fory, Holder.class));\n'})}),"\n",(0,s.jsx)(n.h3,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'Person person = new Person();\nperson.setName("Alice");\nperson.setPet(Animal.ofDog(new Dog()));\n\nbyte[] data = person.toBytes();\nPerson restored = Person.fromBytes(data);\n'})}),"\n",(0,s.jsx)(n.h2,{id:"python",children:"Python"}),"\n",(0,s.jsx)(n.h3,{id:"output-layout-1",children:"Output Layout"}),"\n",(0,s.jsx)(n.p,{children:"Python output is one module per schema file, for example:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"<python_out>/addressbook.py"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"type-generation-1",children:"Type Generation"}),"\n",(0,s.jsxs)(n.p,{children:["Unions generate a case enum plus a ",(0,s.jsx)(n.code,{children:"Union"})," subclass with typed helpers:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'class AnimalCase(Enum):\n    DOG = 1\n    CAT = 2\n\nclass Animal(Union):\n    @classmethod\n    def dog(cls, v: Dog) -> "Animal": ...\n\n    def case(self) -> AnimalCase: ...\n    def case_id(self) -> int: ...\n\n    def is_dog(self) -> bool: ...\n    def dog_value(self) -> Dog: ...\n    def set_dog(self, v: Dog) -> None: ...\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Messages generate ",(0,s.jsx)(n.code,{children:"@pyfory.dataclass"})," types, and nested types stay nested:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'@pyfory.dataclass\nclass Person:\n    class PhoneType(IntEnum):\n        MOBILE = 0\n        HOME = 1\n        WORK = 2\n\n    @pyfory.dataclass\n    class PhoneNumber:\n        number: str = pyfory.field(id=1, default="")\n        phone_type: Person.PhoneType = pyfory.field(id=2, default=None)\n\n    name: str = pyfory.field(id=1, default="")\n    phones: List[Person.PhoneNumber] = pyfory.field(id=7, default_factory=list)\n    pet: Animal = pyfory.field(id=8, default=None)\n\n    def to_bytes(self) -> bytes: ...\n    @classmethod\n    def from_bytes(cls, data: bytes) -> "Person": ...\n'})}),"\n",(0,s.jsx)(n.h3,{id:"registration-1",children:"Registration"}),"\n",(0,s.jsx)(n.p,{children:"Generated registration function:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"def register_addressbook_types(fory: pyfory.Fory):\n    fory.register_union(Animal, type_id=106, serializer=AnimalSerializer(fory))\n    fory.register_type(Person, type_id=100)\n    fory.register_type(Person.PhoneType, type_id=101)\n    fory.register_type(Person.PhoneNumber, type_id=102)\n    fory.register_type(Dog, type_id=104)\n    fory.register_type(Cat, type_id=105)\n    fory.register_type(AddressBook, type_id=103)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For schemas without explicit ",(0,s.jsx)(n.code,{children:"[id=...]"}),", generated registration uses computed numeric IDs:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"fory.register_type(Status, type_id=1124725126)\nfory.register_union(Wrapper, type_id=1471345060, serializer=WrapperSerializer(fory))\nfory.register_type(Envelope, type_id=3022445236)\nfory.register_union(Envelope.Detail, type_id=1609214087, serializer=Envelope.DetailSerializer(fory))\nfory.register_type(Envelope.Payload, type_id=2862577837)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If ",(0,s.jsx)(n.code,{children:"option enable_auto_type_id = false;"})," is set:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'fory.register_type(Config, namespace="myapp.models", typename="Config")\nfory.register_union(\n    Holder,\n    namespace="myapp.models",\n    typename="Holder",\n    serializer=HolderSerializer(fory),\n)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"usage-1",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'person = Person(name="Alice", pet=Animal.dog(Dog(name="Rex", bark_volume=10)))\n\ndata = person.to_bytes()\nrestored = Person.from_bytes(data)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"rust",children:"Rust"}),"\n",(0,s.jsx)(n.h3,{id:"output-layout-2",children:"Output Layout"}),"\n",(0,s.jsx)(n.p,{children:"Rust output is one module file per schema, for example:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"<rust_out>/addressbook.rs"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"type-generation-2",children:"Type Generation"}),"\n",(0,s.jsxs)(n.p,{children:["Unions map to Rust enums with ",(0,s.jsx)(n.code,{children:"#[fory(id = ...)]"})," case attributes:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"#[derive(ForyObject, Debug, Clone, PartialEq)]\npub enum Animal {\n    #[fory(id = 1)]\n    Dog(Dog),\n    #[fory(id = 2)]\n    Cat(Cat),\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Nested types generate nested modules:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"pub mod person {\n    #[derive(ForyObject, Debug, Clone, PartialEq, Default)]\n    #[repr(i32)]\n    pub enum PhoneType {\n        #[default]\n        Mobile = 0,\n        Home = 1,\n        Work = 2,\n    }\n\n    #[derive(ForyObject, Debug, Clone, PartialEq, Default)]\n    pub struct PhoneNumber {\n        #[fory(id = 1)]\n        pub number: String,\n        #[fory(id = 2)]\n        pub phone_type: PhoneType,\n    }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Messages derive ",(0,s.jsx)(n.code,{children:"ForyObject"})," and include ",(0,s.jsx)(n.code,{children:"to_bytes"}),"/",(0,s.jsx)(n.code,{children:"from_bytes"})," helpers:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:'#[derive(ForyObject, Debug, Clone, PartialEq, Default)]\npub struct Person {\n    #[fory(id = 1)]\n    pub name: String,\n    #[fory(id = 7)]\n    pub phones: Vec<person::PhoneNumber>,\n    #[fory(id = 8, type_id = "union")]\n    pub pet: Animal,\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"registration-2",children:"Registration"}),"\n",(0,s.jsx)(n.p,{children:"Generated registration function:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"pub fn register_types(fory: &mut Fory) -> Result<(), fory::Error> {\n    fory.register_union::<Animal>(106)?;\n    fory.register::<person::PhoneType>(101)?;\n    fory.register::<person::PhoneNumber>(102)?;\n    fory.register::<Person>(100)?;\n    fory.register::<Dog>(104)?;\n    fory.register::<Cat>(105)?;\n    fory.register::<AddressBook>(103)?;\n    Ok(())\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For schemas without explicit ",(0,s.jsx)(n.code,{children:"[id=...]"}),", generated registration uses computed numeric IDs:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"fory.register::<Status>(1124725126)?;\nfory.register_union::<Wrapper>(1471345060)?;\nfory.register::<Envelope>(3022445236)?;\nfory.register_union::<envelope::Detail>(1609214087)?;\nfory.register::<envelope::Payload>(2862577837)?;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If ",(0,s.jsx)(n.code,{children:"option enable_auto_type_id = false;"})," is set:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:'fory.register_by_namespace::<Config>("myapp.models", "Config")?;\nfory.register_union_by_namespace::<Holder>("myapp.models", "Holder")?;\n'})}),"\n",(0,s.jsx)(n.h3,{id:"usage-2",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:'let person = Person {\n    name: "Alice".into(),\n    pet: Animal::Dog(Dog::default()),\n    ..Default::default()\n};\n\nlet bytes = person.to_bytes()?;\nlet restored = Person::from_bytes(&bytes)?;\n'})}),"\n",(0,s.jsx)(n.h2,{id:"c",children:"C++"}),"\n",(0,s.jsx)(n.h3,{id:"output-layout-3",children:"Output Layout"}),"\n",(0,s.jsx)(n.p,{children:"C++ output is one header per schema file, for example:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"<cpp_out>/addressbook.h"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"type-generation-3",children:"Type Generation"}),"\n",(0,s.jsxs)(n.p,{children:["Messages generate ",(0,s.jsx)(n.code,{children:"final"})," classes with typed accessors and byte helpers:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"class Person final {\n public:\n  class PhoneNumber final {\n   public:\n    const std::string& number() const;\n    std::string* mutable_number();\n    template <class Arg, class... Args>\n    void set_number(Arg&& arg, Args&&... args);\n\n    fory::Result<std::vector<uint8_t>, fory::Error> to_bytes() const;\n    static fory::Result<PhoneNumber, fory::Error> from_bytes(const std::vector<uint8_t>& data);\n  };\n\n  const std::string& name() const;\n  std::string* mutable_name();\n  template <class Arg, class... Args>\n  void set_name(Arg&& arg, Args&&... args);\n\n  const Animal& pet() const;\n  Animal* mutable_pet();\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Optional message fields generate ",(0,s.jsx)(n.code,{children:"has_xxx"}),", ",(0,s.jsx)(n.code,{children:"mutable_xxx"}),", and ",(0,s.jsx)(n.code,{children:"clear_xxx"})," APIs:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"class Envelope final {\n public:\n  bool has_payload() const { return payload_ != nullptr; }\n  const Envelope::Payload& payload() const { return *payload_; }\n  Envelope::Payload* mutable_payload() {\n    if (!payload_) {\n      payload_ = std::make_unique<Envelope::Payload>();\n    }\n    return payload_.get();\n  }\n  void clear_payload() { payload_.reset(); }\n\n private:\n  std::unique_ptr<Envelope::Payload> payload_;\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Unions generate ",(0,s.jsx)(n.code,{children:"std::variant"})," wrappers:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"class Animal final {\n public:\n  enum class AnimalCase : uint32_t {\n    DOG = 1,\n    CAT = 2,\n  };\n\n  static Animal dog(Dog v);\n  static Animal cat(Cat v);\n\n  AnimalCase animal_case() const noexcept;\n  uint32_t animal_case_id() const noexcept;\n\n  bool is_dog() const noexcept;\n  const Dog* as_dog() const noexcept;\n  Dog* as_dog() noexcept;\n  const Dog& dog() const;\n  Dog& dog();\n\n  template <class Visitor>\n  decltype(auto) visit(Visitor&& vis) const;\n\n private:\n  std::variant<Dog, Cat> value_;\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Generated headers also include ",(0,s.jsx)(n.code,{children:"FORY_UNION"}),", ",(0,s.jsx)(n.code,{children:"FORY_FIELD_CONFIG"}),", ",(0,s.jsx)(n.code,{children:"FORY_ENUM"}),", and ",(0,s.jsx)(n.code,{children:"FORY_STRUCT"})," macros for serialization metadata."]}),"\n",(0,s.jsx)(n.h3,{id:"registration-3",children:"Registration"}),"\n",(0,s.jsx)(n.p,{children:"Generated registration function:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"inline void register_types(fory::serialization::BaseFory& fory) {\n    fory.register_union<Animal>(106);\n    fory.register_enum<Person::PhoneType>(101);\n    fory.register_struct<Person::PhoneNumber>(102);\n    fory.register_struct<Person>(100);\n    fory.register_struct<Dog>(104);\n    fory.register_struct<Cat>(105);\n    fory.register_struct<AddressBook>(103);\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For schemas without explicit ",(0,s.jsx)(n.code,{children:"[id=...]"}),", generated registration uses computed numeric IDs:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"fory.register_enum<Status>(1124725126);\nfory.register_union<Wrapper>(1471345060);\nfory.register_struct<Envelope>(3022445236);\nfory.register_union<Envelope::Detail>(1609214087);\nfory.register_struct<Envelope::Payload>(2862577837);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If ",(0,s.jsx)(n.code,{children:"option enable_auto_type_id = false;"})," is set:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:'fory.register_struct<Config>("myapp.models", "Config");\nfory.register_union<Holder>("myapp.models", "Holder");\n'})}),"\n",(0,s.jsx)(n.h3,{id:"usage-3",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:'addressbook::Person person;\nperson.set_name("Alice");\n*person.mutable_pet() = addressbook::Animal::dog(addressbook::Dog{});\n\nauto bytes = person.to_bytes();\nauto restored = addressbook::Person::from_bytes(bytes.value());\n'})}),"\n",(0,s.jsx)(n.h2,{id:"go",children:"Go"}),"\n",(0,s.jsx)(n.h3,{id:"output-layout-4",children:"Output Layout"}),"\n",(0,s.jsxs)(n.p,{children:["Go output path depends on schema options and ",(0,s.jsx)(n.code,{children:"--go_out"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["For ",(0,s.jsx)(n.code,{children:"addressbook.fdl"}),", ",(0,s.jsx)(n.code,{children:"go_package"})," is configured and generated output follows the configured import path/package (for example under your ",(0,s.jsx)(n.code,{children:"--go_out"})," root)."]}),"\n",(0,s.jsxs)(n.p,{children:["Without ",(0,s.jsx)(n.code,{children:"go_package"}),", output uses the requested ",(0,s.jsx)(n.code,{children:"--go_out"})," directory and package-derived file naming."]}),"\n",(0,s.jsx)(n.h3,{id:"type-generation-4",children:"Type Generation"}),"\n",(0,s.jsxs)(n.p,{children:["Nested types use underscore naming by default (",(0,s.jsx)(n.code,{children:"Person_PhoneType"}),", ",(0,s.jsx)(n.code,{children:"Person_PhoneNumber"}),"):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'type Person_PhoneType int32\n\nconst (\n    Person_PhoneTypeMobile Person_PhoneType = 0\n    Person_PhoneTypeHome   Person_PhoneType = 1\n    Person_PhoneTypeWork   Person_PhoneType = 2\n)\n\ntype Person_PhoneNumber struct {\n    Number    string           `fory:"id=1"`\n    PhoneType Person_PhoneType `fory:"id=2"`\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Messages generate structs with ",(0,s.jsx)(n.code,{children:"fory"})," tags and byte helpers:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'type Person struct {\n    Name   string               `fory:"id=1"`\n    Id     int32                `fory:"id=2,compress=true"`\n    Phones []Person_PhoneNumber `fory:"id=7"`\n    Pet    Animal               `fory:"id=8"`\n}\n\nfunc (m *Person) ToBytes() ([]byte, error) { ... }\nfunc (m *Person) FromBytes(data []byte) error { ... }\n'})}),"\n",(0,s.jsx)(n.p,{children:"Unions generate typed case structs with constructors/accessors/visitor APIs:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"type AnimalCase uint32\n\ntype Animal struct {\n    case_ AnimalCase\n    value any\n}\n\nfunc DogAnimal(v *Dog) Animal { ... }\nfunc CatAnimal(v *Cat) Animal { ... }\n\nfunc (u Animal) Case() AnimalCase { ... }\nfunc (u Animal) AsDog() (*Dog, bool) { ... }\nfunc (u Animal) Visit(visitor AnimalVisitor) error { ... }\n"})}),"\n",(0,s.jsx)(n.h3,{id:"registration-4",children:"Registration"}),"\n",(0,s.jsx)(n.p,{children:"Generated registration function:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"func RegisterTypes(f *fory.Fory) error {\n    if err := f.RegisterUnion(Animal{}, 106, fory.NewUnionSerializer(...)); err != nil {\n        return err\n    }\n    if err := f.RegisterEnum(Person_PhoneType(0), 101); err != nil {\n        return err\n    }\n    if err := f.RegisterStruct(Person_PhoneNumber{}, 102); err != nil {\n        return err\n    }\n    if err := f.RegisterStruct(Person{}, 100); err != nil {\n        return err\n    }\n    return nil\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For schemas without explicit ",(0,s.jsx)(n.code,{children:"[id=...]"}),", generated registration uses computed numeric IDs:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"if err := f.RegisterEnum(Status(0), 1124725126); err != nil { ... }\nif err := f.RegisterUnion(Wrapper{}, 1471345060, fory.NewUnionSerializer(...)); err != nil { ... }\nif err := f.RegisterStruct(Envelope{}, 3022445236); err != nil { ... }\nif err := f.RegisterUnion(Envelope_Detail{}, 1609214087, fory.NewUnionSerializer(...)); err != nil { ... }\nif err := f.RegisterStruct(Envelope_Payload{}, 2862577837); err != nil { ... }\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If ",(0,s.jsx)(n.code,{children:"option enable_auto_type_id = false;"})," is set:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'if err := f.RegisterNamedStruct(Config{}, "myapp.models.Config"); err != nil { ... }\nif err := f.RegisterNamedUnion(Holder{}, "myapp.models.Holder", fory.NewUnionSerializer(...)); err != nil { ... }\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"go_nested_type_style"})," controls nested type naming:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-protobuf",children:'option go_nested_type_style = "camelcase";\n'})}),"\n",(0,s.jsx)(n.h3,{id:"usage-4",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'person := &Person{\n    Name: "Alice",\n    Pet:  DogAnimal(&Dog{Name: "Rex"}),\n}\n\ndata, err := person.ToBytes()\nif err != nil {\n    panic(err)\n}\nvar restored Person\nif err := restored.FromBytes(data); err != nil {\n    panic(err)\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"c-1",children:"C#"}),"\n",(0,s.jsx)(n.h3,{id:"output-layout-5",children:"Output Layout"}),"\n",(0,s.jsxs)(n.p,{children:["C# output is one ",(0,s.jsx)(n.code,{children:".cs"})," file per schema, for example:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"<csharp_out>/addressbook/addressbook.cs"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"type-generation-5",children:"Type Generation"}),"\n",(0,s.jsxs)(n.p,{children:["Messages generate ",(0,s.jsx)(n.code,{children:"[ForyObject]"})," classes with C# properties and byte helpers:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"[ForyObject]\npublic sealed partial class Person\n{\n    public string Name { get; set; } = string.Empty;\n    public int Id { get; set; }\n    public List<Person.PhoneNumber> Phones { get; set; } = new();\n    public Animal Pet { get; set; } = null!;\n\n    public byte[] ToBytes() { ... }\n    public static Person FromBytes(byte[] data) { ... }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Unions generate ",(0,s.jsx)(n.code,{children:"Union"})," subclasses with typed case helpers:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"public sealed class Animal : Union\n{\n    public static Animal Dog(Dog value) { ... }\n    public static Animal Cat(Cat value) { ... }\n    public bool IsDog => ...;\n    public Dog DogValue() { ... }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"registration-5",children:"Registration"}),"\n",(0,s.jsx)(n.p,{children:"Each schema generates a registration helper:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"public static class AddressbookForyRegistration\n{\n    public static void Register(Fory fory)\n    {\n        fory.Register<addressbook.Animal>((uint)106);\n        fory.Register<addressbook.Person>((uint)100);\n        // ...\n    }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"When explicit type IDs are not provided, generated registration uses computed\nnumeric IDs (same behavior as other targets)."}),"\n",(0,s.jsx)(n.h2,{id:"cross-language-notes",children:"Cross-Language Notes"}),"\n",(0,s.jsx)(n.h3,{id:"type-id-behavior",children:"Type ID Behavior"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Explicit ",(0,s.jsx)(n.code,{children:"[id=...]"})," values are used directly in generated registration."]}),"\n",(0,s.jsxs)(n.li,{children:["When type IDs are omitted, generated code uses computed numeric IDs (see ",(0,s.jsx)(n.code,{children:"auto_id.*"})," outputs)."]}),"\n",(0,s.jsxs)(n.li,{children:["If ",(0,s.jsx)(n.code,{children:"option enable_auto_type_id = false;"})," is set, generated registration uses namespace/type-name APIs instead of numeric IDs."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"nested-type-shape",children:"Nested Type Shape"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Language"}),(0,s.jsx)(n.th,{children:"Nested type form"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Java"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Person.PhoneNumber"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Python"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Person.PhoneNumber"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Rust"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"person::PhoneNumber"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"C++"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Person::PhoneNumber"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Go"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"Person_PhoneNumber"})," (default)"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"C#"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Person.PhoneNumber"})})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"byte-helper-naming",children:"Byte Helper Naming"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Language"}),(0,s.jsx)(n.th,{children:"Helpers"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Java"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"toBytes"})," / ",(0,s.jsx)(n.code,{children:"fromBytes"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Python"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"to_bytes"})," / ",(0,s.jsx)(n.code,{children:"from_bytes"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Rust"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"to_bytes"})," / ",(0,s.jsx)(n.code,{children:"from_bytes"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"C++"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"to_bytes"})," / ",(0,s.jsx)(n.code,{children:"from_bytes"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Go"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"ToBytes"})," / ",(0,s.jsx)(n.code,{children:"FromBytes"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"C#"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"ToBytes"})," / ",(0,s.jsx)(n.code,{children:"FromBytes"})]})]})]})]})]})}function p(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},11151:(e,n,r)=>{r.d(n,{Z:()=>a,a:()=>t});var s=r(67294);const i={},o=s.createContext(i);function t(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);