"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[33976],{71639:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var r=i(85893),s=i(11151);const a={title:"C++ Serialization Guide",sidebar_position:0,id:"serialization_index",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},t=void 0,o={id:"guide/cpp/serialization_index",title:"C++ Serialization Guide",description:"Apache Fory\u2122 is a blazing fast multi-language serialization framework powered by JIT compilation and zero-copy techniques, providing up to ultra-fast performance while maintaining ease of use and safety.",source:"@site/versioned_docs/version-0.14/guide/cpp/index.md",sourceDirName:"guide/cpp",slug:"/guide/cpp/",permalink:"/docs/0.14/guide/cpp/",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/docs/guide/cpp/index.md",tags:[],version:"0.14",sidebarPosition:0,frontMatter:{title:"C++ Serialization Guide",sidebar_position:0,id:"serialization_index",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"Troubleshooting",permalink:"/docs/0.14/guide/rust/troubleshooting"},next:{title:"Configuration",permalink:"/docs/0.14/guide/cpp/configuration"}},l={},d=[{value:"Why Apache Fory\u2122 C++?",id:"why-apache-fory-c",level:2},{value:"Installation",id:"installation",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Using CMake (Recommended)",id:"using-cmake-recommended",level:3},{value:"Using Bazel",id:"using-bazel",level:3},{value:"Examples",id:"examples",level:3},{value:"Quick Start",id:"quick-start",level:2},{value:"Basic Example",id:"basic-example",level:3},{value:"Thread Safety",id:"thread-safety",level:2},{value:"Single-Threaded (Fastest)",id:"single-threaded-fastest",level:3},{value:"Thread-Safe",id:"thread-safe",level:3},{value:"Use Cases",id:"use-cases",level:2},{value:"Object Serialization",id:"object-serialization",level:3},{value:"Row-Based Serialization",id:"row-based-serialization",level:3},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Apache Fory\u2122"})," is a blazing fast multi-language serialization framework powered by ",(0,r.jsx)(n.strong,{children:"JIT compilation"})," and ",(0,r.jsx)(n.strong,{children:"zero-copy"})," techniques, providing up to ",(0,r.jsx)(n.strong,{children:"ultra-fast performance"})," while maintaining ease of use and safety."]}),"\n",(0,r.jsx)(n.p,{children:"The C++ implementation provides high-performance serialization with compile-time type safety using modern C++17 features and template metaprogramming."}),"\n",(0,r.jsx)(n.h2,{id:"why-apache-fory-c",children:"Why Apache Fory\u2122 C++?"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\ud83d\udd25 Blazingly Fast"}),": Fast serialization and optimized binary protocols"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\ud83c\udf0d Cross-Language"}),": Seamlessly serialize/deserialize data across Java, Python, C++, Go, JavaScript, and Rust"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\ud83c\udfaf Type-Safe"}),": Compile-time type checking with macro-based struct registration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\ud83d\udd04 Reference Tracking"}),": Automatic tracking of shared and circular references"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\ud83d\udce6 Schema Evolution"}),": Compatible mode for independent schema changes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u26a1 Two Formats"}),": Object graph serialization and zero-copy row-based format"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\ud83e\uddf5 Thread Safety"}),": Both single-threaded (fastest) and thread-safe variants"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.p,{children:"The C++ implementation supports both CMake and Bazel build systems."}),"\n",(0,r.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"CMake 3.16+ (for CMake build) or Bazel 8+ (for Bazel build)"}),"\n",(0,r.jsx)(n.li,{children:"C++17 compatible compiler (GCC 7+, Clang 5+, MSVC 2017+)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"using-cmake-recommended",children:"Using CMake (Recommended)"}),"\n",(0,r.jsxs)(n.p,{children:["The easiest way to use Fory is with CMake's ",(0,r.jsx)(n.code,{children:"FetchContent"})," module:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cmake",children:"cmake_minimum_required(VERSION 3.16)\nproject(my_project LANGUAGES CXX)\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\ninclude(FetchContent)\nFetchContent_Declare(\n    fory\n    GIT_REPOSITORY https://github.com/apache/fory.git\n    GIT_TAG        v0.14.1\n    SOURCE_SUBDIR  cpp\n)\nFetchContent_MakeAvailable(fory)\n\nadd_executable(my_app main.cc)\ntarget_link_libraries(my_app PRIVATE fory::serialization)\n"})}),"\n",(0,r.jsx)(n.p,{children:"Then build and run:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"mkdir build && cd build\ncmake .. -DCMAKE_BUILD_TYPE=Release\ncmake --build . --parallel\n./my_app\n"})}),"\n",(0,r.jsx)(n.h3,{id:"using-bazel",children:"Using Bazel"}),"\n",(0,r.jsxs)(n.p,{children:["Create a ",(0,r.jsx)(n.code,{children:"MODULE.bazel"})," file in your project root:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bazel",children:'module(\n    name = "my_project",\n    version = "1.0.0",\n)\n\nbazel_dep(name = "rules_cc", version = "0.1.1")\n\nbazel_dep(name = "fory", version = "0.14.1")\ngit_override(\n    module_name = "fory",\n    remote = "https://github.com/apache/fory.git",\n    commit = "v0.14.1",  # Or use a specific commit hash for reproducibility\n)\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Create a ",(0,r.jsx)(n.code,{children:"BUILD"})," file for your application:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bazel",children:'cc_binary(\n    name = "my_app",\n    srcs = ["main.cc"],\n    deps = ["@fory//cpp/fory/serialization:fory_serialization"],\n)\n'})}),"\n",(0,r.jsx)(n.p,{children:"Then build and run:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"bazel build //:my_app\nbazel run //:my_app\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For local development, you can use ",(0,r.jsx)(n.code,{children:"local_path_override"})," instead:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bazel",children:'bazel_dep(name = "fory", version = "0.14.1")\nlocal_path_override(\n    module_name = "fory",\n    path = "/path/to/fory",\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"https://github.com/apache/fory/tree/main/examples/cpp",children:"examples/cpp"})," directory for complete working examples:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/apache/fory/tree/main/examples/cpp/hello_world",children:"hello_world"})," - Object graph serialization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/apache/fory/tree/main/examples/cpp/hello_row",children:"hello_row"})," - Row format encoding"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,r.jsx)(n.h3,{id:"basic-example",children:"Basic Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#include "fory/serialization/fory.h"\n\nusing namespace fory::serialization;\n\n// Define a struct\nstruct Person {\n  std::string name;\n  int32_t age;\n  std::vector<std::string> hobbies;\n\n  bool operator==(const Person &other) const {\n    return name == other.name && age == other.age && hobbies == other.hobbies;\n  }\n};\n\n// Register the struct with Fory (must be in the same namespace)\nFORY_STRUCT(Person, name, age, hobbies);\n\nint main() {\n  // Create a Fory instance\n  auto fory = Fory::builder()\n      .xlang(true)          // Enable cross-language mode\n      .track_ref(false)     // Disable reference tracking for simple types\n      .build();\n\n  // Register the type with a unique ID\n  fory.register_struct<Person>(1);\n\n  // Create an object\n  Person person{"Alice", 30, {"reading", "coding"}};\n\n  // Serialize\n  auto result = fory.serialize(person);\n  if (!result.ok()) {\n    // Handle error\n    return 1;\n  }\n  std::vector<uint8_t> bytes = std::move(result).value();\n\n  // Deserialize\n  auto deser_result = fory.deserialize<Person>(bytes);\n  if (!deser_result.ok()) {\n    // Handle error\n    return 1;\n  }\n  Person decoded = std::move(deser_result).value();\n\n  assert(person == decoded);\n  return 0;\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"thread-safety",children:"Thread Safety"}),"\n",(0,r.jsx)(n.p,{children:"Apache Fory\u2122 C++ provides two variants for different threading needs:"}),"\n",(0,r.jsx)(n.h3,{id:"single-threaded-fastest",children:"Single-Threaded (Fastest)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"// Single-threaded Fory - fastest, NOT thread-safe\nauto fory = Fory::builder()\n    .xlang(true)\n    .build();\n"})}),"\n",(0,r.jsx)(n.h3,{id:"thread-safe",children:"Thread-Safe"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"// Thread-safe Fory - uses context pools\nauto fory = Fory::builder()\n    .xlang(true)\n    .build_thread_safe();\n\n// Can be used from multiple threads safely\nstd::thread t1([&]() {\n  auto result = fory.serialize(obj1);\n});\nstd::thread t2([&]() {\n  auto result = fory.serialize(obj2);\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Tip:"})," Perform type registrations before spawning threads so every worker sees the same metadata."]}),"\n",(0,r.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,r.jsx)(n.h3,{id:"object-serialization",children:"Object Serialization"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Complex data structures with nested objects and references"}),"\n",(0,r.jsx)(n.li,{children:"Cross-language communication in microservices"}),"\n",(0,r.jsx)(n.li,{children:"General-purpose serialization with full type safety"}),"\n",(0,r.jsx)(n.li,{children:"Schema evolution with compatible mode"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"row-based-serialization",children:"Row-Based Serialization"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"High-throughput data processing"}),"\n",(0,r.jsx)(n.li,{children:"Analytics workloads requiring fast field access"}),"\n",(0,r.jsx)(n.li,{children:"Memory-constrained environments"}),"\n",(0,r.jsx)(n.li,{children:"Zero-copy scenarios"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/0.14/guide/cpp/configuration",children:"Configuration"})," - Builder options and modes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/0.14/guide/cpp/basic_serialization",children:"Basic Serialization"})," - Object graph serialization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/0.14/guide/cpp/schema_evolution",children:"Schema Evolution"})," - Compatible mode and schema changes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/0.14/guide/cpp/type_registration",children:"Type Registration"})," - Registering types"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/0.14/guide/cpp/supported_types",children:"Supported Types"})," - All supported types"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/0.14/guide/cpp/cross_language",children:"Cross-Language"})," - XLANG mode"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/0.14/guide/cpp/row_format",children:"Row Format"})," - Zero-copy row-based format"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>o,a:()=>t});var r=i(67294);const s={},a=r.createContext(s);function t(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);