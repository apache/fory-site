"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[25896],{27553:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>t,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>d});var l=n(85893),a=n(11151);const s={title:"Default Values",sidebar_position:3,id:"default_values",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},t=void 0,r={id:"guide/kotlin/default_values",title:"Default Values",description:"Fory supports Kotlin data class default values during deserialization when using compatible mode. This feature enables forward/backward compatibility when data class schemas evolve.",source:"@site/docs/guide/kotlin/default-values.md",sourceDirName:"guide/kotlin",slug:"/guide/kotlin/default_values",permalink:"/docs/next/guide/kotlin/default_values",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/docs/guide/kotlin/default-values.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Default Values",sidebar_position:3,id:"default_values",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"Type Serialization",permalink:"/docs/next/guide/kotlin/type_serialization"},next:{title:"Cross-Language Serialization Guide",permalink:"/docs/next/guide/xlang/"}},o={},d=[{value:"Overview",id:"overview",level:2},{value:"Usage",id:"usage",level:2},{value:"Example",id:"example",level:2},{value:"Supported Default Value Types",id:"supported-default-value-types",level:2},{value:"Complex Default Values",id:"complex-default-values",level:2},{value:"Nullable Fields with Defaults",id:"nullable-fields-with-defaults",level:2},{value:"Related Topics",id:"related-topics",level:2}];function c(e){const i={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.p,{children:"Fory supports Kotlin data class default values during deserialization when using compatible mode. This feature enables forward/backward compatibility when data class schemas evolve."}),"\n",(0,l.jsx)(i.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsx)(i.p,{children:"When a Kotlin data class has parameters with default values, Fory can:"}),"\n",(0,l.jsxs)(i.ol,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Detect default values"})," using Kotlin reflection"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Apply default values"})," during deserialization when fields are missing from serialized data"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Support schema evolution"})," by allowing new fields with defaults to be added without breaking existing serialized data"]}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"usage",children:"Usage"}),"\n",(0,l.jsx)(i.p,{children:"This feature is automatically enabled when:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:["Compatible mode is enabled (",(0,l.jsx)(i.code,{children:"withCompatibleMode(CompatibleMode.COMPATIBLE)"}),")"]}),"\n",(0,l.jsxs)(i.li,{children:["Kotlin serializers are registered (",(0,l.jsx)(i.code,{children:"KotlinSerializers.registerSerializers(fory)"}),")"]}),"\n",(0,l.jsx)(i.li,{children:"A field is missing from the serialized data but exists in the target class with a default value"}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"example",children:"Example"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-kotlin",children:'import org.apache.fory.Fory\nimport org.apache.fory.config.CompatibleMode\nimport org.apache.fory.serializer.kotlin.KotlinSerializers\n\n// Original data class\ndata class User(val name: String, val age: Int)\n\n// Evolved data class with new field and default value\ndata class UserV2(val name: String, val age: Int, val email: String = "default@example.com")\n\nfun main() {\n    val fory = Fory.builder()\n        .withCompatibleMode(CompatibleMode.COMPATIBLE)\n        .build()\n    KotlinSerializers.registerSerializers(fory)\n    fory.register(User::class.java)\n    fory.register(UserV2::class.java)\n\n    // Serialize with old schema\n    val oldUser = User("John", 30)\n    val serialized = fory.serialize(oldUser)\n\n    // Deserialize with new schema - missing field gets default value\n    val newUser = fory.deserialize(serialized) as UserV2\n    println(newUser) // UserV2(name=John, age=30, email=default@example.com)\n}\n'})}),"\n",(0,l.jsx)(i.h2,{id:"supported-default-value-types",children:"Supported Default Value Types"}),"\n",(0,l.jsx)(i.p,{children:"The following types are supported for default values:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Primitive types"}),": ",(0,l.jsx)(i.code,{children:"Int"}),", ",(0,l.jsx)(i.code,{children:"Long"}),", ",(0,l.jsx)(i.code,{children:"Double"}),", ",(0,l.jsx)(i.code,{children:"Float"}),", ",(0,l.jsx)(i.code,{children:"Boolean"}),", ",(0,l.jsx)(i.code,{children:"Byte"}),", ",(0,l.jsx)(i.code,{children:"Short"}),", ",(0,l.jsx)(i.code,{children:"Char"})]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Unsigned types"}),": ",(0,l.jsx)(i.code,{children:"UInt"}),", ",(0,l.jsx)(i.code,{children:"ULong"}),", ",(0,l.jsx)(i.code,{children:"UByte"}),", ",(0,l.jsx)(i.code,{children:"UShort"})]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"String"}),": ",(0,l.jsx)(i.code,{children:"String"})]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Collections"}),": ",(0,l.jsx)(i.code,{children:"List"}),", ",(0,l.jsx)(i.code,{children:"Set"}),", ",(0,l.jsx)(i.code,{children:"Map"})," (with default instances)"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.strong,{children:"Custom objects"}),": Any object that can be instantiated via reflection"]}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"complex-default-values",children:"Complex Default Values"}),"\n",(0,l.jsx)(i.p,{children:"Default values can be complex expressions:"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-kotlin",children:'data class ConfigV1(val name: String)\n\ndata class ConfigV2(\n    val name: String,\n    val settings: Map<String, String> = mapOf("default" to "value"),\n    val tags: List<String> = listOf("default"),\n    val enabled: Boolean = true,\n    val retryCount: Int = 3\n)\n\nval fory = Fory.builder()\n    .withCompatibleMode(CompatibleMode.COMPATIBLE)\n    .build()\nKotlinSerializers.registerSerializers(fory)\n\nval original = ConfigV1("myConfig")\nval serialized = fory.serialize(original)\n\nval deserialized = fory.deserialize(serialized) as ConfigV2\n// deserialized.name == "myConfig"\n// deserialized.settings == mapOf("default" to "value")\n// deserialized.tags == listOf("default")\n// deserialized.enabled == true\n// deserialized.retryCount == 3\n'})}),"\n",(0,l.jsx)(i.h2,{id:"nullable-fields-with-defaults",children:"Nullable Fields with Defaults"}),"\n",(0,l.jsx)(i.p,{children:"Nullable fields with default values are also supported:"}),"\n",(0,l.jsx)(i.pre,{children:(0,l.jsx)(i.code,{className:"language-kotlin",children:'data class PersonV1(val name: String)\n\ndata class PersonV2(\n    val name: String,\n    val nickname: String? = null,\n    val age: Int? = null\n)\n\nval original = PersonV1("John")\nval serialized = fory.serialize(original)\n\nval deserialized = fory.deserialize(serialized) as PersonV2\n// deserialized.name == "John"\n// deserialized.nickname == null (default)\n// deserialized.age == null (default)\n'})}),"\n",(0,l.jsx)(i.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.a,{href:"/docs/next/guide/java/schema_evolution",children:"Schema Evolution"})," - Forward/backward compatibility in Java"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.a,{href:"/docs/next/guide/kotlin/fory_creation",children:"Fory Creation"})," - Setting up Fory with compatible mode"]}),"\n"]})]})}function u(e={}){const{wrapper:i}={...(0,a.a)(),...e.components};return i?(0,l.jsx)(i,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},11151:(e,i,n)=>{n.d(i,{Z:()=>r,a:()=>t});var l=n(67294);const a={},s=l.createContext(a);function t(e){const i=l.useContext(s);return l.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),l.createElement(s.Provider,{value:i},e.children)}}}]);