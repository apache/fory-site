"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[38968],{22224:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>d,contentTitle:()=>t,default:()=>u,frontMatter:()=>n,metadata:()=>r,toc:()=>o});var i=s(85893),l=s(11151);const n={title:"Default Values",sidebar_position:3,id:"default_values",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},t=void 0,r={id:"guide/scala/default_values",title:"Default Values",description:"Fory supports Scala class default values during deserialization when using compatible mode. This feature enables forward/backward compatibility when case classes or regular Scala classes have default parameters.",source:"@site/docs/guide/scala/default-values.md",sourceDirName:"guide/scala",slug:"/guide/scala/default_values",permalink:"/docs/next/guide/scala/default_values",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/docs/guide/scala/default-values.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Default Values",sidebar_position:3,id:"default_values",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"Type Serialization",permalink:"/docs/next/guide/scala/type_serialization"},next:{title:"Kotlin Serialization Guide",permalink:"/docs/next/guide/kotlin/"}},d={},o=[{value:"Overview",id:"overview",level:2},{value:"Supported Class Types",id:"supported-class-types",level:2},{value:"How It Works",id:"how-it-works",level:2},{value:"Usage",id:"usage",level:2},{value:"Examples",id:"examples",level:2},{value:"Case Class with Default Values",id:"case-class-with-default-values",level:3},{value:"Regular Scala Class with Default Values",id:"regular-scala-class-with-default-values",level:3},{value:"Complex Default Values",id:"complex-default-values",level:3},{value:"Nested Case Classes",id:"nested-case-classes",level:3},{value:"Related Topics",id:"related-topics",level:2}];function c(e){const a={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.p,{children:"Fory supports Scala class default values during deserialization when using compatible mode. This feature enables forward/backward compatibility when case classes or regular Scala classes have default parameters."}),"\n",(0,i.jsx)(a.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(a.p,{children:["When a Scala class has default parameters, the Scala compiler generates methods in the companion object (for case classes) or in the class itself (for regular Scala classes) like ",(0,i.jsx)(a.code,{children:"apply$default$1"}),", ",(0,i.jsx)(a.code,{children:"apply$default$2"}),", etc. that return the default values. Fory can detect these methods and use them when deserializing objects where certain fields are missing from the serialized data."]}),"\n",(0,i.jsx)(a.h2,{id:"supported-class-types",children:"Supported Class Types"}),"\n",(0,i.jsx)(a.p,{children:"Fory supports default values for:"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Case classes"})," with default parameters"]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Regular Scala classes"})," with default parameters in their primary constructor"]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.strong,{children:"Nested case classes"})," with default parameters"]}),"\n"]}),"\n",(0,i.jsx)(a.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,i.jsxs)(a.ol,{children:["\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsxs)(a.p,{children:[(0,i.jsx)(a.strong,{children:"Detection"}),": Fory detects if a class is a Scala class by checking for the presence of default value methods (",(0,i.jsx)(a.code,{children:"apply$default$N"})," or ",(0,i.jsx)(a.code,{children:"$default$N"}),")."]}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsxs)(a.p,{children:[(0,i.jsx)(a.strong,{children:"Default Value Discovery"}),":"]}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:["For case classes: Fory scans the companion object for methods named ",(0,i.jsx)(a.code,{children:"apply$default$1"}),", ",(0,i.jsx)(a.code,{children:"apply$default$2"}),", etc."]}),"\n",(0,i.jsxs)(a.li,{children:["For regular Scala classes: Fory scans the class itself for methods named ",(0,i.jsx)(a.code,{children:"$default$1"}),", ",(0,i.jsx)(a.code,{children:"$default$2"}),", etc."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsxs)(a.p,{children:[(0,i.jsx)(a.strong,{children:"Field Mapping"}),": During deserialization, Fory identifies fields that exist in the target class but are missing from the serialized data."]}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsxs)(a.p,{children:[(0,i.jsx)(a.strong,{children:"Value Application"}),": After reading all available fields from the serialized data, Fory applies default values to any missing fields."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(a.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(a.p,{children:"This feature is automatically enabled when:"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:["Compatible mode is enabled (",(0,i.jsx)(a.code,{children:"withCompatibleMode(CompatibleMode.COMPATIBLE)"}),")"]}),"\n",(0,i.jsx)(a.li,{children:"The target class is detected as a Scala class with default values"}),"\n",(0,i.jsx)(a.li,{children:"A field is missing from the serialized data but exists in the target class"}),"\n"]}),"\n",(0,i.jsx)(a.p,{children:"No additional configuration is required."}),"\n",(0,i.jsx)(a.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(a.h3,{id:"case-class-with-default-values",children:"Case Class with Default Values"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-scala",children:'import org.apache.fory.Fory\nimport org.apache.fory.config.CompatibleMode\nimport org.apache.fory.serializer.scala.ScalaSerializers\n\n// Class WITHOUT default values (for serialization)\ncase class PersonV1(name: String)\n\n// Class WITH default values (for deserialization)\ncase class PersonV2(name: String, age: Int = 25, city: String = "Unknown")\n\nval fory = Fory.builder()\n  .withCompatibleMode(CompatibleMode.COMPATIBLE)\n  .withScalaOptimizationEnabled(true)\n  .build()\n\nScalaSerializers.registerSerializers(fory)\n\n// Serialize using class without default values\nval original = PersonV1("John")\nval serialized = fory.serialize(original)\n\n// Deserialize into class with default values\n// Missing fields will use defaults\nval deserialized = fory.deserialize(serialized).asInstanceOf[PersonV2]\n// deserialized.name == "John"\n// deserialized.age == 25 (default)\n// deserialized.city == "Unknown" (default)\n'})}),"\n",(0,i.jsx)(a.h3,{id:"regular-scala-class-with-default-values",children:"Regular Scala Class with Default Values"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-scala",children:'// Class WITHOUT default values (for serialization)\nclass EmployeeV1(val name: String)\n\n// Class WITH default values (for deserialization)\nclass EmployeeV2(\n  val name: String,\n  val age: Int = 30,\n  val department: String = "Engineering"\n)\n\nval fory = Fory.builder()\n  .withCompatibleMode(CompatibleMode.COMPATIBLE)\n  .withScalaOptimizationEnabled(true)\n  .build()\n\nScalaSerializers.registerSerializers(fory)\n\n// Serialize using class without default values\nval original = new EmployeeV1("Jane")\nval serialized = fory.serialize(original)\n\n// Deserialize into class with default values\nval deserialized = fory.deserialize(serialized).asInstanceOf[EmployeeV2]\n// deserialized.name == "Jane"\n// deserialized.age == 30 (default)\n// deserialized.department == "Engineering" (default)\n'})}),"\n",(0,i.jsx)(a.h3,{id:"complex-default-values",children:"Complex Default Values"}),"\n",(0,i.jsx)(a.p,{children:"Default values can be complex expressions:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-scala",children:'// Class WITHOUT default values (for serialization)\ncase class ConfigV1(name: String)\n\n// Class WITH default values (for deserialization)\ncase class ConfigV2(\n  name: String,\n  settings: Map[String, String] = Map("default" -> "value"),\n  tags: List[String] = List("default"),\n  enabled: Boolean = true\n)\n\nval fory = Fory.builder()\n  .withCompatibleMode(CompatibleMode.COMPATIBLE)\n  .withScalaOptimizationEnabled(true)\n  .build()\n\nScalaSerializers.registerSerializers(fory)\n\nval original = ConfigV1("myConfig")\nval serialized = fory.serialize(original)\n\nval deserialized = fory.deserialize(serialized).asInstanceOf[ConfigV2]\n// deserialized.name == "myConfig"\n// deserialized.settings == Map("default" -> "value")\n// deserialized.tags == List("default")\n// deserialized.enabled == true\n'})}),"\n",(0,i.jsx)(a.h3,{id:"nested-case-classes",children:"Nested Case Classes"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-scala",children:'object Models {\n  // Class WITHOUT default values (for serialization)\n  case class PersonV1(name: String)\n\n  // Classes WITH default values (for deserialization)\n  case class Address(street: String, city: String = "DefaultCity")\n  case class PersonV2(name: String, address: Address = Address("DefaultStreet"))\n}\n\nval fory = Fory.builder()\n  .withCompatibleMode(CompatibleMode.COMPATIBLE)\n  .withScalaOptimizationEnabled(true)\n  .build()\n\nScalaSerializers.registerSerializers(fory)\n\nval original = Models.PersonV1("Alice")\nval serialized = fory.serialize(original)\n\nval deserialized = fory.deserialize(serialized).asInstanceOf[Models.PersonV2]\n// deserialized.name == "Alice"\n// deserialized.address == Address("DefaultStreet", "DefaultCity")\n'})}),"\n",(0,i.jsx)(a.h2,{id:"related-topics",children:"Related Topics"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.a,{href:"/docs/next/guide/java/schema_evolution",children:"Schema Evolution"})," - Forward/backward compatibility in Java"]}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.a,{href:"/docs/next/guide/scala/fory_creation",children:"Fory Creation"})," - Setting up Fory with compatible mode"]}),"\n"]})]})}function u(e={}){const{wrapper:a}={...(0,l.a)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},11151:(e,a,s)=>{s.d(a,{Z:()=>r,a:()=>t});var i=s(67294);const l={},n=i.createContext(l);function t(e){const a=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function r(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(n.Provider,{value:a},e.children)}}}]);