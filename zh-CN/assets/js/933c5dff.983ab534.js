"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[2446],{14950:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>c});var s=r(85893),i=r(11151);const t={title:"\u6545\u969c\u6392\u67e5",sidebar_position:110,id:"troubleshooting",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},d=void 0,l={id:"guide/go/troubleshooting",title:"\u6545\u969c\u6392\u67e5",description:"\u672c\u6307\u5357\u6c47\u603b\u4e86\u4f7f\u7528 Fory Go \u65f6\u7684\u5e38\u89c1\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6848\u3002",source:"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/guide/go/troubleshooting.md",sourceDirName:"guide/go",slug:"/guide/go/troubleshooting",permalink:"/zh-CN/docs/next/guide/go/troubleshooting",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/i18n/zh-CN/docusaurus-plugin-content-docs/current/guide/go/troubleshooting.md",tags:[],version:"current",sidebarPosition:110,frontMatter:{title:"\u6545\u969c\u6392\u67e5",sidebar_position:110,id:"troubleshooting",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"\u7ebf\u7a0b\u5b89\u5168",permalink:"/zh-CN/docs/next/guide/go/thread_safety"},next:{title:"C# Serialization Guide",permalink:"/zh-CN/docs/next/guide/csharp/"}},a={},c=[{value:"\u9519\u8bef\u7c7b\u578b",id:"\u9519\u8bef\u7c7b\u578b",level:2},{value:"\u9519\u8bef\u79cd\u7c7b",id:"\u9519\u8bef\u79cd\u7c7b",level:3},{value:"\u5e38\u89c1\u9519\u8bef\u4e0e\u89e3\u51b3\u65b9\u6848",id:"\u5e38\u89c1\u9519\u8bef\u4e0e\u89e3\u51b3\u65b9\u6848",level:2},{value:"ErrKindUnknownType",id:"errkindunknowntype",level:3},{value:"ErrKindTypeMismatch",id:"errkindtypemismatch",level:3},{value:"ErrKindHashMismatch",id:"errkindhashmismatch",level:3},{value:"ErrKindMaxDepthExceeded",id:"errkindmaxdepthexceeded",level:3},{value:"ErrKindBufferOutOfBound",id:"errkindbufferoutofbound",level:3},{value:"ErrKindInvalidRefId",id:"errkindinvalidrefid",level:3},{value:"ErrKindInvalidTag",id:"errkindinvalidtag",level:3},{value:"Cross-Language Issues",id:"cross-language-issues",level:2},{value:"Field Order Mismatch",id:"field-order-mismatch",level:3},{value:"Name Registration Mismatch",id:"name-registration-mismatch",level:3},{value:"Performance Issues",id:"performance-issues",level:2},{value:"Slow Serialization",id:"slow-serialization",level:3},{value:"High Memory Usage",id:"high-memory-usage",level:3},{value:"Thread Contention",id:"thread-contention",level:3},{value:"Debugging Techniques",id:"debugging-techniques",level:2},{value:"Enable Debug Output",id:"enable-debug-output",level:3},{value:"Inspect Serialized Data",id:"inspect-serialized-data",level:3},{value:"Check Type Registration",id:"check-type-registration",level:3},{value:"Compare Struct Hashes",id:"compare-struct-hashes",level:3},{value:"Testing Tips",id:"testing-tips",level:2},{value:"Test Round-Trip",id:"test-round-trip",level:3},{value:"Test Cross-Language",id:"test-cross-language",level:3},{value:"Test Schema Evolution",id:"test-schema-evolution",level:3},{value:"Getting Help",id:"getting-help",level:2},{value:"\u76f8\u5173\u4e3b\u9898",id:"\u76f8\u5173\u4e3b\u9898",level:2}];function o(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"\u672c\u6307\u5357\u6c47\u603b\u4e86\u4f7f\u7528 Fory Go \u65f6\u7684\u5e38\u89c1\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6848\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u9519\u8bef\u7c7b\u578b",children:"\u9519\u8bef\u7c7b\u578b"}),"\n",(0,s.jsx)(n.p,{children:"Fory Go uses typed errors with specific error kinds:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"type Error struct {\n    kind    ErrorKind\n    message string\n    // Additional context fields\n}\n\nfunc (e Error) Kind() ErrorKind { return e.kind }\nfunc (e Error) Error() string   { return e.message }\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u9519\u8bef\u79cd\u7c7b",children:"\u9519\u8bef\u79cd\u7c7b"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Kind"}),(0,s.jsx)(n.th,{children:"Value"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ErrKindOK"})}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"No error"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ErrKindBufferOutOfBound"})}),(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"Read/write beyond buffer bounds"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ErrKindTypeMismatch"})}),(0,s.jsx)(n.td,{children:"2"}),(0,s.jsx)(n.td,{children:"Type ID mismatch"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ErrKindUnknownType"})}),(0,s.jsx)(n.td,{children:"3"}),(0,s.jsx)(n.td,{children:"Unknown type encountered"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ErrKindSerializationFailed"})}),(0,s.jsx)(n.td,{children:"4"}),(0,s.jsx)(n.td,{children:"General serialization failure"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ErrKindDeserializationFailed"})}),(0,s.jsx)(n.td,{children:"5"}),(0,s.jsx)(n.td,{children:"General deserialization failure"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ErrKindMaxDepthExceeded"})}),(0,s.jsx)(n.td,{children:"6"}),(0,s.jsx)(n.td,{children:"Recursion depth limit exceeded"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ErrKindNilPointer"})}),(0,s.jsx)(n.td,{children:"7"}),(0,s.jsx)(n.td,{children:"Unexpected nil pointer"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ErrKindInvalidRefId"})}),(0,s.jsx)(n.td,{children:"8"}),(0,s.jsx)(n.td,{children:"Invalid reference ID"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ErrKindHashMismatch"})}),(0,s.jsx)(n.td,{children:"9"}),(0,s.jsx)(n.td,{children:"Struct hash mismatch"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"ErrKindInvalidTag"})}),(0,s.jsx)(n.td,{children:"10"}),(0,s.jsx)(n.td,{children:"Invalid fory struct tag"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"\u5e38\u89c1\u9519\u8bef\u4e0e\u89e3\u51b3\u65b9\u6848",children:"\u5e38\u89c1\u9519\u8bef\u4e0e\u89e3\u51b3\u65b9\u6848"}),"\n",(0,s.jsx)(n.h3,{id:"errkindunknowntype",children:"ErrKindUnknownType"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Error"}),": ",(0,s.jsx)(n.code,{children:"unknown type encountered"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Type not registered before serialization/deserialization."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"f := fory.New()\n\n// Register type before use\nf.RegisterStruct(User{}, 1)\n\n// Now serialization works\ndata, _ := f.Serialize(&User{ID: 1})\n"})}),"\n",(0,s.jsx)(n.h3,{id:"errkindtypemismatch",children:"ErrKindTypeMismatch"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Error"}),": ",(0,s.jsx)(n.code,{children:"type mismatch: expected X, got Y"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Serialized data has different type than expected."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use correct target type"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"// Wrong: Deserializing User into Order\nvar order Order\nf.Deserialize(userData, &order)  // Error!\n\n// Correct\nvar user User\nf.Deserialize(userData, &user)\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ensure consistent registration"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"// Serializer\nf1 := fory.New()\nf1.RegisterStruct(User{}, 1)\n\n// Deserializer - must use same ID\nf2 := fory.New()\nf2.RegisterStruct(User{}, 1)  // Same ID!\n"})}),"\n",(0,s.jsx)(n.h3,{id:"errkindhashmismatch",children:"ErrKindHashMismatch"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Error"}),": ",(0,s.jsx)(n.code,{children:"hash X is not consistent with Y for type Z"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Struct definition changed between serialization and deserialization."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enable compatible mode"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"f := fory.New(fory.WithCompatible(true))\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ensure struct definitions match"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"// Both serializer and deserializer must have same struct\ntype User struct {\n    ID   int64\n    Name string\n}\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Regenerate codegen"})," (if using):"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"go generate ./...\n"})}),"\n",(0,s.jsx)(n.h3,{id:"errkindmaxdepthexceeded",children:"ErrKindMaxDepthExceeded"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Error"}),": ",(0,s.jsx)(n.code,{children:"max depth exceeded"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Data nesting exceeds maximum depth limit."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Possible causes"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Deeply nested data structures exceeding the default limit (20)"}),"\n",(0,s.jsx)(n.li,{children:"Unintended circular references without reference tracking enabled"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Malicious data"}),": Attackers may craft deeply nested payloads to cause resource exhaustion"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Increase max depth"})," (default is 20):"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"f := fory.New(fory.WithMaxDepth(50))\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enable reference tracking"})," (for circular data):"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"f := fory.New(fory.WithTrackRef(true))\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Check for unintended circular references"})," in your data."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Validate untrusted data"}),": When deserializing data from untrusted sources, do not blindly increase max depth. Consider validating input size and structure before deserialization."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"errkindbufferoutofbound",children:"ErrKindBufferOutOfBound"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Error"}),": ",(0,s.jsx)(n.code,{children:"buffer out of bound: offset=X, need=Y, size=Z"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Reading beyond available data."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ensure complete data transfer"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"// Wrong: Truncated data\ndata := fullData[:100]\nf.Deserialize(data, &target)  // Error if data was larger\n\n// Correct: Use full data\nf.Deserialize(fullData, &target)\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Check for data corruption"}),": Verify data integrity during transmission."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"errkindinvalidrefid",children:"ErrKindInvalidRefId"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Error"}),": ",(0,s.jsx)(n.code,{children:"invalid reference ID"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Reference to non-existent object in serialized data."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ensure reference tracking consistency"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"// Serializer and deserializer must have same setting\nf1 := fory.New(fory.WithTrackRef(true))\nf2 := fory.New(fory.WithTrackRef(true))  // Must match!\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Check for data corruption"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"errkindinvalidtag",children:"ErrKindInvalidTag"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Error"}),": ",(0,s.jsx)(n.code,{children:"invalid fory struct tag"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Invalid struct tag configuration."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Common causes"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Invalid tag ID"}),": ID must be >= -1"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'// Wrong: negative ID (other than -1)\ntype Bad struct {\n    Field int `fory:"id=-5"`\n}\n\n// Correct\ntype Good struct {\n    Field int `fory:"id=0"`\n}\n'})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Duplicate tag IDs"}),": Each field must have a unique ID within the struct"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'// Wrong: duplicate IDs\ntype Bad struct {\n    Field1 int `fory:"id=0"`\n    Field2 int `fory:"id=0"`  // Duplicate!\n}\n\n// Correct\ntype Good struct {\n    Field1 int `fory:"id=0"`\n    Field2 int `fory:"id=1"`\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"cross-language-issues",children:"Cross-Language Issues"}),"\n",(0,s.jsx)(n.h3,{id:"field-order-mismatch",children:"Field Order Mismatch"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptom"}),": Data deserializes but fields have wrong values."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause"}),": Different field ordering between languages. In non-compatible mode, fields are sorted by their snake_case names. CamelCase field names (e.g., ",(0,s.jsx)(n.code,{children:"FirstName"}),") are converted to snake_case (e.g., ",(0,s.jsx)(n.code,{children:"first_name"}),") for sorting."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ensure converted snake_case names are consistent"}),": Field names across languages must produce the same snake_case ordering:"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"type User struct {\n    FirstName string  // Go: FirstName -> first_name\n    LastName  string  // Go: LastName -> last_name\n    // Sorted alphabetically by snake_case: first_name, last_name\n}\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use field IDs for consistent ordering"}),": Field IDs (non-negative integers) act as aliases for field names, used for both sorting and field matching during deserialization:"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'type User struct {\n    FirstName string `fory:"id=0"`\n    LastName  string `fory:"id=1"`\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Ensure the same field IDs are used across all languages for corresponding fields."}),"\n",(0,s.jsx)(n.h3,{id:"name-registration-mismatch",children:"Name Registration Mismatch"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptom"}),": ",(0,s.jsx)(n.code,{children:"unknown type"})," in other languages."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution"}),": Use identical names:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'// Go\nf.RegisterNamedStruct(User{}, "example.User")\n\n// Java - must match exactly\nfory.register(User.class, "example.User");\n\n// Python\nfory.register(User, typename="example.User")\n'})}),"\n",(0,s.jsx)(n.h2,{id:"performance-issues",children:"Performance Issues"}),"\n",(0,s.jsx)(n.h3,{id:"slow-serialization",children:"Slow Serialization"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Possible causes"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Large object graphs"}),": Reduce data size or serialize incrementally."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Excessive reference tracking"}),": Disable if not needed:"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"f := fory.New(fory.WithTrackRef(false))\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Deep nesting"}),": Flatten data structures where possible."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"high-memory-usage",children:"High Memory Usage"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Possible causes"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Large serialized data"}),": Process in chunks."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Reference tracking overhead"}),": Disable if not needed."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Buffer not released"}),": Reuse buffers:"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"buf := fory.NewByteBuffer(nil)\nf.SerializeTo(buf, value)\n// Process data\nbuf.Reset()  // Reuse for next serialization\n"})}),"\n",(0,s.jsx)(n.h3,{id:"thread-contention",children:"Thread Contention"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptom"}),": Slowdown under concurrent load."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Use per-goroutine instances"})," for hot paths:"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:"func worker() {\n    f := fory.New()  // Each worker has own instance\n    for task := range tasks {\n        f.Serialize(task)\n    }\n}\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Profile pool usage"})," with thread-safe wrapper."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"debugging-techniques",children:"Debugging Techniques"}),"\n",(0,s.jsx)(n.h3,{id:"enable-debug-output",children:"Enable Debug Output"}),"\n",(0,s.jsx)(n.p,{children:"Set environment variable:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ENABLE_FORY_DEBUG_OUTPUT=1 go test ./...\n"})}),"\n",(0,s.jsx)(n.h3,{id:"inspect-serialized-data",children:"Inspect Serialized Data"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'data, _ := f.Serialize(value)\nfmt.Printf("Serialized %d bytes\\n", len(data))\nfmt.Printf("Header: %x\\n", data[:4])  // Magic + flags\n'})}),"\n",(0,s.jsx)(n.h3,{id:"check-type-registration",children:"Check Type Registration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'// Verify type is registered\nf := fory.New()\nerr := f.RegisterStruct(User{}, 1)\nif err != nil {\n    fmt.Printf("Registration failed: %v\\n", err)\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"compare-struct-hashes",children:"Compare Struct Hashes"}),"\n",(0,s.jsx)(n.p,{children:"If getting hash mismatch, compare struct definitions:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'// Print struct info for debugging\nt := reflect.TypeOf(User{})\nfor i := 0; i < t.NumField(); i++ {\n    f := t.Field(i)\n    fmt.Printf("Field: %s, Type: %s\\n", f.Name, f.Type)\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"testing-tips",children:"Testing Tips"}),"\n",(0,s.jsx)(n.h3,{id:"test-round-trip",children:"Test Round-Trip"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'func TestRoundTrip(t *testing.T) {\n    f := fory.New()\n    f.RegisterStruct(User{}, 1)\n\n    original := &User{ID: 1, Name: "Alice"}\n\n    data, err := f.Serialize(original)\n    require.NoError(t, err)\n\n    var result User\n    err = f.Deserialize(data, &result)\n    require.NoError(t, err)\n\n    assert.Equal(t, original.ID, result.ID)\n    assert.Equal(t, original.Name, result.Name)\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"test-cross-language",children:"Test Cross-Language"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd java/fory-core\nFORY_GO_JAVA_CI=1 mvn test -Dtest=org.apache.fory.xlang.GoXlangTest\n"})}),"\n",(0,s.jsx)(n.h3,{id:"test-schema-evolution",children:"Test Schema Evolution"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'func TestSchemaEvolution(t *testing.T) {\n    f1 := fory.New(fory.WithCompatible(true))\n    f1.RegisterStruct(UserV1{}, 1)\n\n    data, _ := f1.Serialize(&UserV1{ID: 1, Name: "Alice"})\n\n    f2 := fory.New(fory.WithCompatible(true))\n    f2.RegisterStruct(UserV2{}, 1)\n\n    var result UserV2\n    err := f2.Deserialize(data, &result)\n    require.NoError(t, err)\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"getting-help",children:"Getting Help"}),"\n",(0,s.jsx)(n.p,{children:"If you encounter issues not covered here:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Check GitHub Issues"}),": ",(0,s.jsx)(n.a,{href:"https://github.com/apache/fory/issues",children:"github.com/apache/fory/issues"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enable debug output"}),": ",(0,s.jsx)(n.code,{children:"ENABLE_FORY_DEBUG_OUTPUT=1"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Create minimal reproduction"}),": Isolate the problem"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Report the issue"}),": Include Go version, Fory version, and minimal code"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u76f8\u5173\u4e3b\u9898",children:"\u76f8\u5173\u4e3b\u9898"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/zh-CN/docs/next/guide/go/configuration",children:"Configuration"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/zh-CN/docs/next/guide/go/cross_language",children:"Cross-Language Serialization"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/zh-CN/docs/next/guide/go/schema_evolution",children:"Schema Evolution"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/zh-CN/docs/next/guide/go/thread_safety",children:"Thread Safety"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},11151:(e,n,r)=>{r.d(n,{Z:()=>l,a:()=>d});var s=r(67294);const i={},t=s.createContext(i);function d(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);