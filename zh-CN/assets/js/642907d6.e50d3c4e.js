"use strict";(self.webpackChunkfory_site=self.webpackChunkfory_site||[]).push([[87400],{93295:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var r=i(85893),s=i(11151);const o={title:"\u57fa\u7840\u5e8f\u5217\u5316",sidebar_position:2,id:"basic_serialization",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},t=void 0,a={id:"guide/python/basic_serialization",title:"\u57fa\u7840\u5e8f\u5217\u5316",description:"\u672c\u9875\u4ecb\u7ecd pyfory \u4e2d\u7684\u57fa\u7840\u5e8f\u5217\u5316\u6a21\u5f0f\u3002",source:"@site/i18n/zh-CN/docusaurus-plugin-content-docs/version-0.15/guide/python/basic-serialization.md",sourceDirName:"guide/python",slug:"/guide/python/basic_serialization",permalink:"/zh-CN/docs/guide/python/basic_serialization",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/fory-site/tree/main/i18n/zh-CN/docusaurus-plugin-content-docs/version-0.15/guide/python/basic-serialization.md",tags:[],version:"0.15",sidebarPosition:2,frontMatter:{title:"\u57fa\u7840\u5e8f\u5217\u5316",sidebar_position:2,id:"basic_serialization",license:'Licensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the "License"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'},sidebar:"docsSidebar",previous:{title:"\u914d\u7f6e",permalink:"/zh-CN/docs/guide/python/configuration"},next:{title:"\u7c7b\u578b\u6ce8\u518c\u4e0e\u5b89\u5168\u6027",permalink:"/zh-CN/docs/guide/python/type_registration"}},d={},l=[{value:"\u57fa\u7840\u5bf9\u8c61\u5e8f\u5217\u5316",id:"\u57fa\u7840\u5bf9\u8c61\u5e8f\u5217\u5316",level:2},{value:"\u81ea\u5b9a\u4e49\u7c7b\u5e8f\u5217\u5316",id:"\u81ea\u5b9a\u4e49\u7c7b\u5e8f\u5217\u5316",level:2},{value:"\u5f15\u7528\u8ddf\u8e2a\u548c\u5faa\u73af\u5f15\u7528",id:"\u5f15\u7528\u8ddf\u8e2a\u548c\u5faa\u73af\u5f15\u7528",level:2},{value:"API \u53c2\u8003",id:"api-\u53c2\u8003",level:2},{value:"\u5e8f\u5217\u5316\u65b9\u6cd5",id:"\u5e8f\u5217\u5316\u65b9\u6cd5",level:3},{value:"\u4f7f\u7528\u5e26\u5916\u7f13\u51b2\u533a",id:"\u4f7f\u7528\u5e26\u5916\u7f13\u51b2\u533a",level:3},{value:"\u6027\u80fd\u63d0\u793a",id:"\u6027\u80fd\u63d0\u793a",level:2},{value:"\u76f8\u5173\u4e3b\u9898",id:"\u76f8\u5173\u4e3b\u9898",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"\u672c\u9875\u4ecb\u7ecd pyfory \u4e2d\u7684\u57fa\u7840\u5e8f\u5217\u5316\u6a21\u5f0f\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u57fa\u7840\u5bf9\u8c61\u5e8f\u5217\u5316",children:"\u57fa\u7840\u5bf9\u8c61\u5e8f\u5217\u5316"}),"\n",(0,r.jsx)(n.p,{children:"\u4f7f\u7528\u7b80\u5355\u7684 API \u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316 Python \u5bf9\u8c61\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import pyfory\n\n# \u521b\u5efa Fory \u5b9e\u4f8b\nfory = pyfory.Fory(xlang=True)\n\n# \u5e8f\u5217\u5316\u4efb\u4f55 Python \u5bf9\u8c61\ndata = fory.dumps({\"name\": \"Alice\", \"age\": 30, \"scores\": [95, 87, 92]})\n\n# \u53cd\u5e8f\u5217\u5316\u56de Python \u5bf9\u8c61\nobj = fory.loads(data)\nprint(obj)  # {'name': 'Alice', 'age': 30, 'scores': [95, 87, 92]}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u6ce8\u610f"}),"\uff1a",(0,r.jsx)(n.code,{children:"dumps()"}),"/",(0,r.jsx)(n.code,{children:"loads()"})," \u662f ",(0,r.jsx)(n.code,{children:"serialize()"}),"/",(0,r.jsx)(n.code,{children:"deserialize()"})," \u7684\u522b\u540d\u3002\u4e24\u4e2a API \u5b8c\u5168\u76f8\u540c\uff0c\u4f7f\u7528\u4efb\u4f55\u4e00\u4e2a\u90fd\u53ef\u4ee5\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"\u81ea\u5b9a\u4e49\u7c7b\u5e8f\u5217\u5316",children:"\u81ea\u5b9a\u4e49\u7c7b\u5e8f\u5217\u5316"}),"\n",(0,r.jsx)(n.p,{children:"Fory \u81ea\u52a8\u5904\u7406 dataclass \u548c\u81ea\u5b9a\u4e49\u7c7b\u578b\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import pyfory\nfrom dataclasses import dataclass\nfrom typing import List, Dict\n\n@dataclass\nclass Person:\n    name: str\n    age: int\n    scores: List[int]\n    metadata: Dict[str, str]\n\n# Python \u6a21\u5f0f - \u652f\u6301\u6240\u6709 Python \u7c7b\u578b\uff0c\u5305\u62ec dataclass\nfory = pyfory.Fory(xlang=False, ref=True)\nfory.register(Person)\nperson = Person("Bob", 25, [88, 92, 85], {"team": "engineering"})\ndata = fory.serialize(person)\nresult = fory.deserialize(data)\nprint(result)  # Person(name=\'Bob\', age=25, ...)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u5f15\u7528\u8ddf\u8e2a\u548c\u5faa\u73af\u5f15\u7528",children:"\u5f15\u7528\u8ddf\u8e2a\u548c\u5faa\u73af\u5f15\u7528"}),"\n",(0,r.jsx)(n.p,{children:"\u5b89\u5168\u5904\u7406\u5171\u4eab\u5f15\u7528\u548c\u5faa\u73af\u4f9d\u8d56\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import pyfory\n\nf = pyfory.Fory(ref=True)  # \u542f\u7528\u5f15\u7528\u8ddf\u8e2a\n\n# \u5b89\u5168\u5904\u7406\u5faa\u73af\u5f15\u7528\nclass Node:\n    def __init__(self, value):\n        self.value = value\n        self.children = []\n        self.parent = None\n\nroot = Node("root")\nchild = Node("child")\nchild.parent = root  # \u5faa\u73af\u5f15\u7528\nroot.children.append(child)\n\n# \u5e8f\u5217\u5316\u4e0d\u4f1a\u5bfc\u81f4\u65e0\u9650\u9012\u5f52\ndata = f.serialize(root)\nresult = f.deserialize(data)\nassert result.children[0].parent is result  # \u5f15\u7528\u88ab\u4fdd\u7559\n'})}),"\n",(0,r.jsx)(n.h2,{id:"api-\u53c2\u8003",children:"API \u53c2\u8003"}),"\n",(0,r.jsx)(n.h3,{id:"\u5e8f\u5217\u5316\u65b9\u6cd5",children:"\u5e8f\u5217\u5316\u65b9\u6cd5"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# \u5e8f\u5217\u5316\u4e3a\u5b57\u8282\ndata: bytes = fory.serialize(obj)\ndata: bytes = fory.dumps(obj)  # \u522b\u540d\n\n# \u4ece\u5b57\u8282\u53cd\u5e8f\u5217\u5316\nobj = fory.deserialize(data)\nobj = fory.loads(data)  # \u522b\u540d\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u4f7f\u7528\u5e26\u5916\u7f13\u51b2\u533a",children:"\u4f7f\u7528\u5e26\u5916\u7f13\u51b2\u533a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# \u4f7f\u7528\u7f13\u51b2\u533a\u56de\u8c03\u5e8f\u5217\u5316\nbuffer_objects = []\ndata = fory.serialize(obj, buffer_callback=buffer_objects.append)\n\n# \u4f7f\u7528\u7f13\u51b2\u533a\u53cd\u5e8f\u5217\u5316\nbuffers = [obj.getbuffer() for obj in buffer_objects]\nobj = fory.deserialize(data, buffers=buffers)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u6027\u80fd\u63d0\u793a",children:"\u6027\u80fd\u63d0\u793a"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["\u5982\u679c\u4e0d\u9700\u8981\u5219\u7981\u7528 ",(0,r.jsx)(n.code,{children:"ref=True"})]}),"\uff1a\u5f15\u7528\u8ddf\u8e2a\u6709\u5f00\u9500"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u4f7f\u7528 type_id \u800c\u4e0d\u662f typename"}),"\uff1a\u6574\u6570 ID \u6bd4\u5b57\u7b26\u4e32\u540d\u79f0\u66f4\u5feb"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u91cd\u7528 Fory \u5b9e\u4f8b"}),"\uff1a\u521b\u5efa\u4e00\u6b21\uff0c\u591a\u6b21\u4f7f\u7528"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u542f\u7528 Cython"}),"\uff1a\u786e\u4fdd ",(0,r.jsx)(n.code,{children:"ENABLE_FORY_CYTHON_SERIALIZATION=1"})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# \u597d\uff1a\u91cd\u7528\u5b9e\u4f8b\nfory = pyfory.Fory()\nfor obj in objects:\n    data = fory.dumps(obj)\n\n# \u574f\uff1a\u6bcf\u6b21\u521b\u5efa\u65b0\u5b9e\u4f8b\nfor obj in objects:\n    fory = pyfory.Fory()  # \u6d6a\u8d39\uff01\n    data = fory.dumps(obj)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u76f8\u5173\u4e3b\u9898",children:"\u76f8\u5173\u4e3b\u9898"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/zh-CN/docs/guide/python/configuration",children:"\u914d\u7f6e"})," - Fory \u53c2\u6570"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/zh-CN/docs/guide/python/type_registration",children:"\u7c7b\u578b\u6ce8\u518c"})," - \u6ce8\u518c\u6a21\u5f0f"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/zh-CN/docs/guide/python/native_mode",children:"Python \u539f\u751f\u6a21\u5f0f"})," - \u51fd\u6570\u548c lambda"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>a,a:()=>t});var r=i(67294);const s={},o=r.createContext(s);function t(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);